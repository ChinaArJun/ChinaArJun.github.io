(window.webpackJsonp=window.webpackJsonp||[]).push([[331],{909:function(t,a,n){"use strict";n.r(a);var e=n(44),s=Object(e.a)({},(function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"_7-1-æ·±å…¥ç†è§£-go-slice"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-æ·±å…¥ç†è§£-go-slice"}},[t._v("#")]),t._v(" 7.1 æ·±å…¥ç†è§£ Go Slice")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://i.imgur.com/lIoSqWC.png",alt:"image"}})]),t._v(" "),n("h2",{attrs:{id:"æ˜¯ä»€ä¹ˆ"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#æ˜¯ä»€ä¹ˆ"}},[t._v("#")]),t._v(" æ˜¯ä»€ä¹ˆ")]),t._v(" "),n("p",[t._v("åœ¨ Go ä¸­ï¼ŒSliceï¼ˆåˆ‡ç‰‡ï¼‰æ˜¯æŠ½è±¡åœ¨ Arrayï¼ˆæ•°ç»„ï¼‰ä¹‹ä¸Šçš„ç‰¹æ®Šç±»å‹ã€‚ä¸ºäº†æ›´å¥½åœ°äº†è§£ Sliceï¼Œç¬¬ä¸€æ­¥éœ€è¦å…ˆå¯¹ Array è¿›è¡Œç†è§£ã€‚æ·±åˆ»äº†è§£ Slice ä¸ Array ä¹‹é—´çš„åŒºåˆ«åï¼Œå°±èƒ½æ›´å¥½çš„å¯¹å…¶åº•å±‚ä¸€ç•ªæ‘¸ç´¢ ğŸ˜„")]),t._v(" "),n("h2",{attrs:{id:"ç”¨æ³•"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ç”¨æ³•"}},[t._v("#")]),t._v(" ç”¨æ³•")]),t._v(" "),n("h3",{attrs:{id:"array"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#array"}},[t._v("#")]),t._v(" Array")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('func main() {\n\tnums := [3]int{}\n\tnums[0] = 1\n\n\tn := nums[0]\n\tn = 2\n\n\tfmt.Printf("nums: %v\\n", nums)\n\tfmt.Printf("n: %d\\n", n)\n}\n')])])]),n("p",[t._v("æˆ‘ä»¬å¯å¾—çŸ¥åœ¨ Go ä¸­ï¼Œæ•°ç»„ç±»å‹éœ€è¦æŒ‡å®šé•¿åº¦å’Œå…ƒç´ ç±»å‹ã€‚åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œå¯å¾—çŸ¥ "),n("code",[t._v("[3]int{}")]),t._v(" è¡¨ç¤º 3 ä¸ªæ•´æ•°çš„æ•°ç»„ï¼Œå¹¶è¿›è¡Œäº†åˆå§‹åŒ–ã€‚åº•å±‚æ•°æ®å­˜å‚¨ä¸ºä¸€æ®µè¿ç»­çš„å†…å­˜ç©ºé—´ï¼Œé€šè¿‡å›ºå®šçš„ç´¢å¼•å€¼ï¼ˆä¸‹æ ‡ï¼‰è¿›è¡Œæ£€ç´¢")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://i.imgur.com/uyO3sS6.png",alt:"image"}})]),t._v(" "),n("p",[t._v("æ•°ç»„åœ¨å£°æ˜åï¼Œå…¶å…ƒç´ çš„åˆå§‹å€¼ï¼ˆä¹Ÿå°±æ˜¯é›¶å€¼ï¼‰ä¸º 0ã€‚å¹¶ä¸”è¯¥å˜é‡å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œä¸éœ€è¦ç‰¹æ®Šæ“ä½œ")]),t._v(" "),n("p",[t._v("åŒæ—¶æ•°ç»„çš„é•¿åº¦æ˜¯å›ºå®šçš„ï¼Œå®ƒçš„é•¿åº¦æ˜¯ç±»å‹çš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤ "),n("code",[t._v("[3]int")]),t._v(" å’Œ "),n("code",[t._v("[4]int")]),t._v(" åœ¨ç±»å‹ä¸Šæ˜¯ä¸åŒçš„ï¼Œä¸èƒ½ç§°ä¸º â€œä¸€ä¸ªä¸œè¥¿â€")]),t._v(" "),n("h4",{attrs:{id:"è¾“å‡ºç»“æœ"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#è¾“å‡ºç»“æœ"}},[t._v("#")]),t._v(" è¾“å‡ºç»“æœ")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("nums: [1 0 0] \nn: 2 \n")])])]),n("h3",{attrs:{id:"slice"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#slice"}},[t._v("#")]),t._v(" Slice")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('func main() {\n\tnums := [3]int{}\n\tnums[0] = 1\n\n\tdnums := nums[:]\n\n\tfmt.Printf("dnums: %v", dnums)\n}\n')])])]),n("p",[t._v("Slice æ˜¯å¯¹ Array çš„æŠ½è±¡ï¼Œç±»å‹ä¸º "),n("code",[t._v("[]T")]),t._v("ã€‚åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œ"),n("code",[t._v("dnums")]),t._v(" å˜é‡é€šè¿‡ "),n("code",[t._v("nums[:]")]),t._v(" è¿›è¡Œèµ‹å€¼ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒSlice å’Œ Array ä¸ä¸€æ ·ï¼Œå®ƒä¸éœ€è¦æŒ‡å®šé•¿åº¦ã€‚ä¹Ÿæ›´åŠ çš„çµæ´»ï¼Œèƒ½å¤Ÿè‡ªåŠ¨æ‰©å®¹")]),t._v(" "),n("h2",{attrs:{id:"æ•°æ®ç»“æ„"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#æ•°æ®ç»“æ„"}},[t._v("#")]),t._v(" æ•°æ®ç»“æ„")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://i.imgur.com/hRRFLOl.png",alt:"image"}})]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("type slice struct {\n\tarray unsafe.Pointer\n\tlen   int\n\tcap   int\n}\n")])])]),n("p",[t._v("Slice çš„åº•å±‚æ•°æ®ç»“æ„å…±åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼Œå¦‚ä¸‹ï¼š")]),t._v(" "),n("ul",[n("li",[t._v("arrayï¼šæŒ‡å‘æ‰€å¼•ç”¨çš„æ•°ç»„æŒ‡é’ˆï¼ˆ"),n("code",[t._v("unsafe.Pointer")]),t._v(" å¯ä»¥è¡¨ç¤ºä»»ä½•å¯å¯»å€çš„å€¼çš„æŒ‡é’ˆï¼‰")]),t._v(" "),n("li",[t._v("lenï¼šé•¿åº¦ï¼Œå½“å‰å¼•ç”¨åˆ‡ç‰‡çš„å…ƒç´ ä¸ªæ•°")]),t._v(" "),n("li",[t._v("capï¼šå®¹é‡ï¼Œå½“å‰å¼•ç”¨åˆ‡ç‰‡çš„å®¹é‡ï¼ˆåº•å±‚æ•°ç»„çš„å…ƒç´ æ€»æ•°ï¼‰")])]),t._v(" "),n("p",[t._v("åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œcap ä¸€å®šæ˜¯å¤§äºæˆ–ç­‰äº len çš„ã€‚å¦åˆ™ä¼šå¯¼è‡´ panic")]),t._v(" "),n("h3",{attrs:{id:"ç¤ºä¾‹"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ç¤ºä¾‹"}},[t._v("#")]),t._v(" ç¤ºä¾‹")]),t._v(" "),n("p",[t._v("ä¸ºäº†æ›´å¥½çš„ç†è§£ï¼Œæˆ‘ä»¬å›é¡¾ä¸Šå°èŠ‚çš„ä»£ç ä¾¿äºæ¼”ç¤ºï¼Œå¦‚ä¸‹ï¼š")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('func main() {\n\tnums := [3]int{}\n\tnums[0] = 1\n\n\tdnums := nums[:]\n\n\tfmt.Printf("dnums: %v", dnums)\n}\n')])])]),n("p",[n("img",{attrs:{src:"https://i.imgur.com/fL1l0Zu.png",alt:"image"}})]),t._v(" "),n("p",[t._v("åœ¨ä»£ç ä¸­ï¼Œå¯è§‚å¯Ÿåˆ° "),n("code",[t._v("dnums := nums[:]")]),t._v("ï¼Œè¿™æ®µä»£ç ç¡®å®šäº† Slice çš„ Pointer æŒ‡å‘æ•°ç»„ï¼Œä¸” len å’Œ cap éƒ½ä¸ºæ•°ç»„çš„åŸºç¡€å±æ€§ã€‚ä¸å›¾ç¤ºè¡¨è¾¾ä¸€è‡´")]),t._v(" "),n("h3",{attrs:{id:"lenã€cap-ä¸åŒ"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#lenã€cap-ä¸åŒ"}},[t._v("#")]),t._v(" lenã€cap ä¸åŒ")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('func main() {\n\tnums := [3]int{}\n\tnums[0] = 1\n\n\tdnums := nums[0:2]\n\n\tfmt.Printf("dnums: %v, len: %d, cap: %d", dnums, len(dnums), cap(dnums))\n}\n')])])]),n("p",[n("img",{attrs:{src:"https://i.imgur.com/Xkf5tvZ.png",alt:"image"}})]),t._v(" "),n("h4",{attrs:{id:"è¾“å‡ºç»“æœ-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#è¾“å‡ºç»“æœ-2"}},[t._v("#")]),t._v(" è¾“å‡ºç»“æœ")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("dnums: [1 0], len: 2, cap: 3\n")])])]),n("p",[t._v("æ˜¾ç„¶ï¼Œåœ¨è¿™é‡ŒæŒ‡å®šäº† "),n("code",[t._v("Slice[0:2]")]),t._v("ï¼Œå› æ­¤ len ä¸ºæ‰€å¼•ç”¨å…ƒç´ çš„ä¸ªæ•°ï¼Œcap ä¸ºæ‰€å¼•ç”¨çš„æ•°ç»„å…ƒç´ æ€»ä¸ªæ•°ã€‚ä¸æœŸå¾…ä¸€è‡´ ğŸ˜„")]),t._v(" "),n("h2",{attrs:{id:"åˆ›å»º"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»º"}},[t._v("#")]),t._v(" åˆ›å»º")]),t._v(" "),n("p",[t._v("Slice çš„åˆ›å»ºæœ‰ä¸¤ç§æ–¹å¼ï¼Œå¦‚ä¸‹ï¼š")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("var []T")]),t._v(" æˆ– "),n("code",[t._v("[]T{}")])]),t._v(" "),n("li",[n("code",[t._v("func makeï¼ˆ[] Tï¼Œlenï¼Œcapï¼‰[] T")])])]),t._v(" "),n("p",[t._v("å¯ä»¥ç•™æ„ make å‡½æ•°ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“ Slice éœ€è¦æŒ‡å‘ä¸€ä¸ª Arrayã€‚é‚£ make æ˜¯æ€ä¹ˆåšçš„å‘¢ï¼Ÿ")]),t._v(" "),n("p",[t._v("å®ƒä¼šåœ¨è°ƒç”¨ make çš„æ—¶å€™ï¼Œåˆ†é…ä¸€ä¸ªæ•°ç»„å¹¶è¿”å›å¼•ç”¨è¯¥æ•°ç»„çš„ Slice")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('func makeslice(et *_type, len, cap int) slice {\n\tmaxElements := maxSliceCap(et.size)\n\tif len < 0 || uintptr(len) > maxElements {\n\t\tpanic(errorString("makeslice: len out of range"))\n\t}\n\n\tif cap < len || uintptr(cap) > maxElements {\n\t\tpanic(errorString("makeslice: cap out of range"))\n\t}\n\n\tp := mallocgc(et.size*uintptr(cap), et, true)\n\treturn slice{p, len, cap}\n}\n')])])]),n("ul",[n("li",[t._v("æ ¹æ®ä¼ å…¥çš„ Slice ç±»å‹ï¼Œè·å–å…¶ç±»å‹èƒ½å¤Ÿç”³è¯·çš„æœ€å¤§å®¹é‡å¤§å°")]),t._v(" "),n("li",[t._v("åˆ¤æ–­ len æ˜¯å¦åˆè§„ï¼Œæ£€æŸ¥æ˜¯å¦åœ¨ 0 < x < maxElements èŒƒå›´å†…")]),t._v(" "),n("li",[t._v("åˆ¤æ–­ cap æ˜¯å¦åˆè§„ï¼Œæ£€æŸ¥æ˜¯å¦åœ¨ len < x < maxElements èŒƒå›´å†…")]),t._v(" "),n("li",[t._v("ç”³è¯· Slice æ‰€éœ€çš„å†…å­˜ç©ºé—´å¯¹è±¡ã€‚è‹¥ä¸ºå¤§å‹å¯¹è±¡ï¼ˆå¤§äº 32 KBï¼‰åˆ™ç›´æ¥ä»å †ä¸­åˆ†é…")]),t._v(" "),n("li",[t._v("è¿”å›ç”³è¯·æˆåŠŸçš„ Slice å†…å­˜åœ°å€å’Œç›¸å…³å±æ€§ï¼ˆé»˜è®¤è¿”å›ç”³è¯·åˆ°çš„å†…å­˜èµ·å§‹åœ°å€ï¼‰")])]),t._v(" "),n("h2",{attrs:{id:"æ‰©å®¹"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#æ‰©å®¹"}},[t._v("#")]),t._v(" æ‰©å®¹")]),t._v(" "),n("p",[t._v("å½“ä½¿ç”¨ Slice æ—¶ï¼Œè‹¥å­˜å‚¨çš„å…ƒç´ ä¸æ–­å¢é•¿ï¼ˆä¾‹å¦‚é€šè¿‡ appendï¼‰ã€‚å½“æ¡ä»¶æ»¡è¶³æ‰©å®¹çš„ç­–ç•¥æ—¶ï¼Œå°†ä¼šè§¦å‘è‡ªåŠ¨æ‰©å®¹")]),t._v(" "),n("p",[t._v("é‚£ä¹ˆåˆ†åˆ«æ˜¯ä»€ä¹ˆè§„åˆ™å‘¢ï¼Ÿè®©æˆ‘ä»¬ä¸€èµ·çœ‹çœ‹æºç æ˜¯æ€ä¹ˆè¯´çš„ ğŸ˜„")]),t._v(" "),n("h3",{attrs:{id:"zerobase"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#zerobase"}},[t._v("#")]),t._v(" zerobase")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('func growslice(et *_type, old slice, cap int) slice {\n\t...\n\tif et.size == 0 {\n\t\tif cap < old.cap {\n\t\t\tpanic(errorString("growslice: cap out of range"))\n\t\t}\n\t\t\n\t\treturn slice{unsafe.Pointer(&zerobase), old.len, cap}\n\t}\n    ...\n}\n')])])]),n("p",[t._v("å½“ Slice size ä¸º 0 æ—¶ï¼Œè‹¥å°†è¦æ‰©å®¹çš„å®¹é‡æ¯”åŸæœ¬çš„å®¹é‡å°ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ï¼ˆä¹Ÿå°±æ˜¯ä¸æ”¯æŒç¼©å®¹æ“ä½œï¼‰ã€‚å¦åˆ™ï¼Œå°†é‡æ–°ç”Ÿæˆä¸€ä¸ªæ–°çš„ Slice è¿”å›ï¼Œå…¶ Pointer æŒ‡å‘ä¸€ä¸ª 0 byte åœ°å€ï¼ˆä¸ä¼šä¿ç•™è€çš„ Array æŒ‡å‘ï¼‰")]),t._v(" "),n("h3",{attrs:{id:"æ‰©å®¹-è®¡ç®—ç­–ç•¥"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#æ‰©å®¹-è®¡ç®—ç­–ç•¥"}},[t._v("#")]),t._v(" æ‰©å®¹ - è®¡ç®—ç­–ç•¥")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("func growslice(et *_type, old slice, cap int) slice {\n    ...\n    newcap := old.cap\n\tdoublecap := newcap + newcap\n\tif cap > doublecap {\n\t\tnewcap = cap\n\t} else {\n\t\tif old.len < 1024 {\n\t\t\tnewcap = doublecap\n\t\t} else {\n\t\t\tfor 0 < newcap && newcap < cap {\n\t\t\t\tnewcap += newcap / 4\n\t\t\t}\n\t\t\t...\n\t\t}\n\t}\n\t...\n}\n")])])]),n("ul",[n("li",[t._v("è‹¥ Slice cap å¤§äº doublecapï¼Œåˆ™æ‰©å®¹åå®¹é‡å¤§å°ä¸º æ–° Slice çš„å®¹é‡ï¼ˆè¶…äº†åŸºå‡†å€¼ï¼Œæˆ‘å°±åªç»™ä½ éœ€è¦çš„å®¹é‡å¤§å°ï¼‰")]),t._v(" "),n("li",[t._v("è‹¥ Slice len å°äº 1024 ä¸ªï¼Œåœ¨æ‰©å®¹æ—¶ï¼Œå¢é•¿å› å­ä¸º 1ï¼ˆä¹Ÿå°±æ˜¯ 3 ä¸ªå˜ 6 ä¸ªï¼‰")]),t._v(" "),n("li",[t._v("è‹¥ Slice len å¤§äº 1024 ä¸ªï¼Œåœ¨æ‰©å®¹æ—¶ï¼Œå¢é•¿å› å­ä¸º 0.25ï¼ˆåŸæœ¬å®¹é‡çš„å››åˆ†ä¹‹ä¸€ï¼‰")])]),t._v(" "),n("p",[t._v("æ³¨ï¼šä¹Ÿå°±æ˜¯å°äº 1024 ä¸ªæ—¶ï¼Œå¢é•¿ 2 å€ã€‚å¤§äº 1024 ä¸ªæ—¶ï¼Œå¢é•¿ 1.25 å€")]),t._v(" "),n("h3",{attrs:{id:"æ‰©å®¹-å†…å­˜ç­–ç•¥"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#æ‰©å®¹-å†…å­˜ç­–ç•¥"}},[t._v("#")]),t._v(" æ‰©å®¹ - å†…å­˜ç­–ç•¥")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('func growslice(et *_type, old slice, cap int) slice {\n    ...\n    var overflow bool\n\tvar lenmem, newlenmem, capmem uintptr\n\tconst ptrSize = unsafe.Sizeof((*byte)(nil))\n\tswitch et.size {\n\tcase 1:\n\t\tlenmem = uintptr(old.len)\n\t\tnewlenmem = uintptr(cap)\n\t\tcapmem = roundupsize(uintptr(newcap))\n\t\toverflow = uintptr(newcap) > _MaxMem\n\t\tnewcap = int(capmem)\n\t    ...\n\t}\n\n\tif cap < old.cap || overflow || capmem > _MaxMem {\n\t\tpanic(errorString("growslice: cap out of range"))\n\t}\n\n\tvar p unsafe.Pointer\n\tif et.kind&kindNoPointers != 0 {\n\t\tp = mallocgc(capmem, nil, false)\n\t\tmemmove(p, old.array, lenmem)\n\t\tmemclrNoHeapPointers(add(p, newlenmem), capmem-newlenmem)\n\t} else {\n\t\tp = mallocgc(capmem, et, true)\n\t\tif !writeBarrier.enabled {\n\t\t\tmemmove(p, old.array, lenmem)\n\t\t} else {\n\t\t\tfor i := uintptr(0); i < lenmem; i += et.size {\n\t\t\t\ttypedmemmove(et, add(p, i), add(old.array, i))\n\t\t\t}\n\t\t}\n\t}\n\t...\n}\n')])])]),n("p",[t._v("1ã€è·å–è€ Slice é•¿åº¦å’Œè®¡ç®—å‡å®šæ‰©å®¹åçš„æ–° Slice å…ƒç´ é•¿åº¦ã€å®¹é‡å¤§å°ä»¥åŠæŒ‡é’ˆåœ°å€ï¼ˆç”¨äºåç»­æ“ä½œå†…å­˜çš„ä¸€ç³»åˆ—æ“ä½œï¼‰")]),t._v(" "),n("p",[t._v("2ã€ç¡®å®šæ–° Slice å®¹é‡å¤§äºè€ Siceï¼Œå¹¶ä¸”æ–°å®¹é‡å†…å­˜å°äºæŒ‡å®šçš„æœ€å¤§å†…å­˜ã€æ²¡æœ‰æº¢å‡ºã€‚å¦åˆ™æŠ›å‡ºå¼‚å¸¸")]),t._v(" "),n("p",[t._v("3ã€è‹¥å…ƒç´ ç±»å‹ä¸º "),n("code",[t._v("kindNoPointers")]),t._v("ï¼Œä¹Ÿå°±æ˜¯"),n("strong",[t._v("éæŒ‡é’ˆ")]),t._v("ç±»å‹ã€‚åˆ™åœ¨è€ Slice åç»§ç»­æ‰©å®¹")]),t._v(" "),n("ul",[n("li",[t._v("ç¬¬ä¸€æ­¥ï¼šæ ¹æ®å…ˆå‰è®¡ç®—çš„ "),n("code",[t._v("capmem")]),t._v("ï¼Œåœ¨è€ Slice cap åç»§ç»­ç”³è¯·å†…å­˜ç©ºé—´ï¼Œå…¶åç”¨äºæ‰©å®¹")]),t._v(" "),n("li",[t._v("ç¬¬äºŒæ­¥ï¼šå°† old.array ä¸Šçš„ n ä¸ª bytesï¼ˆæ ¹æ® lenmemï¼‰æ‹·è´åˆ°æ–°çš„å†…å­˜ç©ºé—´ä¸Š")]),t._v(" "),n("li",[t._v("ç¬¬ä¸‰æ­¥ï¼šæ–°å†…å­˜ç©ºé—´ï¼ˆpï¼‰åŠ ä¸Šæ–° Slice cap çš„å®¹é‡åœ°å€ã€‚æœ€ç»ˆå¾—åˆ°å®Œæ•´çš„æ–° Slice cap å†…å­˜åœ°å€ "),n("code",[t._v("add(p, newlenmem)")]),t._v(" ï¼ˆptrï¼‰")]),t._v(" "),n("li",[t._v("ç¬¬å››æ­¥ï¼šä» ptr å¼€å§‹é‡æ–°åˆå§‹åŒ– n ä¸ª bytesï¼ˆcapmem-newlenmemï¼‰")])]),t._v(" "),n("p",[t._v("æ³¨ï¼šé‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œä¸ºä»€ä¹ˆè¦é‡æ–°åˆå§‹åŒ–è¿™å—å†…å­˜å‘¢ï¼Ÿè¿™æ˜¯å› ä¸º ptr æ˜¯æœªåˆå§‹åŒ–çš„å†…å­˜ï¼ˆä¾‹å¦‚ï¼šå¯é‡ç”¨çš„å†…å­˜ï¼Œä¸€èˆ¬ç”¨äºæ–°çš„å†…å­˜åˆ†é…ï¼‰ï¼Œå…¶å¯èƒ½åŒ…å« â€œåƒåœ¾â€ã€‚å› æ­¤åœ¨è¿™é‡Œåº”å½“è¿›è¡Œ â€œæ¸…ç†â€ã€‚ä¾¿äºåé¢å®é™…ä½¿ç”¨ï¼ˆæ‰©å®¹ï¼‰")]),t._v(" "),n("p",[t._v("4ã€ä¸æ»¡è¶³ 3 çš„æƒ…å†µä¸‹ï¼Œé‡æ–°ç”³è¯·å¹¶åˆå§‹åŒ–ä¸€å—å†…å­˜ç»™æ–° Slice ç”¨äºå­˜å‚¨ Array")]),t._v(" "),n("p",[t._v("5ã€æ£€æµ‹å½“å‰æ˜¯å¦æ­£åœ¨æ‰§è¡Œ GCï¼Œä¹Ÿå°±æ˜¯å½“å‰æ˜¯å¦å¯ç”¨ Write Barrierï¼ˆå†™å±éšœï¼‰ï¼Œè‹¥"),n("strong",[t._v("å¯ç”¨")]),t._v("åˆ™é€šè¿‡ "),n("code",[t._v("typedmemmove")]),t._v(" æ–¹æ³•ï¼Œåˆ©ç”¨æŒ‡é’ˆè¿ç®—"),n("strong",[t._v("å¾ªç¯æ‹·è´")]),t._v("ã€‚å¦åˆ™é€šè¿‡ "),n("code",[t._v("memmove")]),t._v(" æ–¹æ³•é‡‡å–"),n("strong",[t._v("æ•´ä½“æ‹·è´")]),t._v("çš„æ–¹å¼å°† lenmem ä¸ªå­—èŠ‚ä» old.array æ‹·è´åˆ° ptrï¼Œä»¥æ­¤è¾¾åˆ°æ›´é«˜çš„æ•ˆç‡")]),t._v(" "),n("p",[t._v("æ³¨ï¼šä¸€èˆ¬ä¼šåœ¨ GC æ ‡è®°é˜¶æ®µå¯ç”¨ Write Barrierï¼Œå¹¶ä¸” Write Barrier åªé’ˆå¯¹æŒ‡é’ˆå¯ç”¨ã€‚é‚£ä¹ˆåœ¨ç¬¬ 5 ç‚¹ä¸­ï¼Œä½ å°±ä¸éš¾ç†è§£ä¸ºä»€ä¹ˆä¼šæœ‰ä¸¤ç§æˆªç„¶ä¸åŒçš„å¤„ç†æ–¹å¼äº†")]),t._v(" "),n("h4",{attrs:{id:"å°ç»“"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å°ç»“"}},[t._v("#")]),t._v(" å°ç»“")]),t._v(" "),n("p",[t._v("è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ‰©å®¹æ—¶çš„å†…å­˜ç®¡ç†çš„é€‰æ‹©é¡¹ï¼Œå¦‚ä¸‹ï¼š")]),t._v(" "),n("ul",[n("li",[t._v("ç¿»æ–°æ‰©å±•ï¼šå½“å‰å…ƒç´ ä¸º "),n("code",[t._v("kindNoPointers")]),t._v("ï¼Œå°†åœ¨è€ Slice cap çš„åœ°å€åç»§ç»­ç”³è¯·ç©ºé—´ç”¨äºæ‰©å®¹")]),t._v(" "),n("li",[t._v("ä¸¾å®¶æ¬è¿ï¼šé‡æ–°ç”³è¯·ä¸€å—å†…å­˜åœ°å€ï¼Œæ•´ä½“è¿ç§»å¹¶æ‰©å®¹")])]),t._v(" "),n("h3",{attrs:{id:"ä¸¤ä¸ªå°-é™·é˜±"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ä¸¤ä¸ªå°-é™·é˜±"}},[t._v("#")]),t._v(" ä¸¤ä¸ªå° â€œé™·é˜±â€")]),t._v(" "),n("h4",{attrs:{id:"ä¸€ã€åŒæ ¹"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ä¸€ã€åŒæ ¹"}},[t._v("#")]),t._v(" ä¸€ã€åŒæ ¹")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('func main() {\n\tnums := [3]int{}\n\tnums[0] = 1\n\n\tfmt.Printf("nums: %v , len: %d, cap: %d\\n", nums, len(nums), cap(nums))\n\n\tdnums := nums[0:2]\n\tdnums[0] = 5\n\n\tfmt.Printf("nums: %v ,len: %d, cap: %d\\n", nums, len(nums), cap(nums))\n\tfmt.Printf("dnums: %v, len: %d, cap: %d\\n", dnums, len(dnums), cap(dnums))\n}\n')])])]),n("p",[t._v("è¾“å‡ºç»“æœï¼š")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("nums: [1 0 0] , len: 3, cap: 3\nnums: [5 0 0] ,len: 3, cap: 3\ndnums: [5 0], len: 2, cap: 3\n")])])]),n("p",[t._v("åœ¨"),n("strong",[t._v("æœªæ‰©å®¹å‰")]),t._v("ï¼ŒSlice array æŒ‡å‘æ‰€å¼•ç”¨çš„ Arrayã€‚å› æ­¤åœ¨ Slice ä¸Šçš„å˜æ›´ã€‚ä¼šç›´æ¥ä¿®æ”¹åˆ°åŸå§‹ Array ä¸Šï¼ˆä¸¤è€…æ‰€å¼•ç”¨çš„æ˜¯åŒä¸€ä¸ªï¼‰")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://i.imgur.com/wCny9zI.png",alt:"image"}})]),t._v(" "),n("h4",{attrs:{id:"äºŒã€æ—¶è¿‡å¢ƒè¿"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#äºŒã€æ—¶è¿‡å¢ƒè¿"}},[t._v("#")]),t._v(" äºŒã€æ—¶è¿‡å¢ƒè¿")]),t._v(" "),n("p",[t._v("éšç€ Slice ä¸æ–­ appendï¼Œå†…åœ¨çš„å…ƒç´ è¶Šæ¥è¶Šå¤šï¼Œç»ˆäºè§¦å‘äº†æ‰©å®¹ã€‚å¦‚ä¸‹ä»£ç ï¼š")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('func main() {\n\tnums := [3]int{}\n\tnums[0] = 1\n\n\tfmt.Printf("nums: %v , len: %d, cap: %d\\n", nums, len(nums), cap(nums))\n\n\tdnums := nums[0:2]\n\tdnums = append(dnums, []int{2, 3}...)\n\tdnums[1] = 1\n\n\tfmt.Printf("nums: %v ,len: %d, cap: %d\\n", nums, len(nums), cap(nums))\n\tfmt.Printf("dnums: %v, len: %d, cap: %d\\n", dnums, len(dnums), cap(dnums))\n}\n')])])]),n("p",[t._v("è¾“å‡ºç»“æœï¼š")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("nums: [1 0 0] , len: 3, cap: 3\nnums: [1 0 0] ,len: 3, cap: 3\ndnums: [1 1 2 3], len: 4, cap: 6\n")])])]),n("p",[t._v("å¾€ Slice append å…ƒç´ æ—¶ï¼Œè‹¥æ»¡è¶³æ‰©å®¹ç­–ç•¥ï¼Œä¹Ÿå°±æ˜¯å‡è®¾æ’å…¥åï¼ŒåŸæœ¬æ•°ç»„çš„å®¹é‡å°±è¶…è¿‡æœ€å¤§å€¼äº†")]),t._v(" "),n("p",[t._v("è¿™æ—¶å€™å†…éƒ¨å°±ä¼šé‡æ–°ç”³è¯·ä¸€å—å†…å­˜ç©ºé—´ï¼Œå°†åŸæœ¬çš„å…ƒç´ "),n("strong",[t._v("æ‹·è´")]),t._v("ä¸€ä»½åˆ°æ–°çš„å†…å­˜ç©ºé—´ä¸Šã€‚æ­¤æ—¶å…¶ä¸åŸæœ¬çš„æ•°ç»„å°±æ²¡æœ‰ä»»ä½•å…³è”å…³ç³»äº†ï¼Œ"),n("strong",[t._v("å†è¿›è¡Œä¿®æ”¹å€¼ä¹Ÿä¸ä¼šå˜åŠ¨åˆ°åŸå§‹æ•°ç»„")]),t._v("ã€‚è¿™æ˜¯éœ€è¦æ³¨æ„çš„")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://i.imgur.com/A3kR8nX.png",alt:"image"}})]),t._v(" "),n("h2",{attrs:{id:"å¤åˆ¶"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å¤åˆ¶"}},[t._v("#")]),t._v(" å¤åˆ¶")]),t._v(" "),n("h3",{attrs:{id:"åŸå‹"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#åŸå‹"}},[t._v("#")]),t._v(" åŸå‹")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("func copyï¼ˆdstï¼Œsrc [] Tï¼‰int\n")])])]),n("p",[t._v("copy å‡½æ•°å°†æ•°æ®ä»"),n("strong",[t._v("æº Slice")]),t._v("å¤åˆ¶åˆ°"),n("strong",[t._v("ç›®æ ‡ Slice")]),t._v("ã€‚å®ƒè¿”å›å¤åˆ¶çš„å…ƒç´ æ•°ã€‚")]),t._v(" "),n("h3",{attrs:{id:"ç¤ºä¾‹-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ç¤ºä¾‹-2"}},[t._v("#")]),t._v(" ç¤ºä¾‹")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('func main() {\n\tdst := []int{1, 2, 3}\n\tsrc := []int{4, 5, 6, 7, 8}\n\tn := copy(dst, src)\n\n\tfmt.Printf("dst: %v, n: %d", dst, n)\n}\n')])])]),n("p",[t._v("copy å‡½æ•°æ”¯æŒåœ¨ä¸åŒé•¿åº¦çš„ Slice ä¹‹é—´è¿›è¡Œå¤åˆ¶ï¼Œè‹¥å‡ºç°é•¿åº¦ä¸ä¸€è‡´ï¼Œåœ¨å¤åˆ¶æ—¶ä¼šæŒ‰ç…§æœ€å°‘çš„ Slice å…ƒç´ ä¸ªæ•°è¿›è¡Œå¤åˆ¶")]),t._v(" "),n("p",[t._v("é‚£ä¹ˆåœ¨æºç ä¸­æ˜¯å¦‚ä½•å®Œæˆå¤åˆ¶è¿™ä¸€ä¸ªè¡Œä¸ºçš„å‘¢ï¼Ÿæˆ‘ä»¬æ¥ä¸€èµ·çœ‹çœ‹æºç çš„å®ç°ï¼Œå¦‚ä¸‹ï¼š")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("func slicecopy(to, fm slice, width uintptr) int {\n\tif fm.len == 0 || to.len == 0 {\n\t\treturn 0\n\t}\n\n\tn := fm.len\n\tif to.len < n {\n\t\tn = to.len\n\t}\n\n\tif width == 0 {\n\t\treturn n\n\t}\n\n\t...\n\n\tsize := uintptr(n) * width\n\tif size == 1 {\n\t\t*(*byte)(to.array) = *(*byte)(fm.array) // known to be a byte pointer\n\t} else {\n\t\tmemmove(to.array, fm.array, size)\n\t}\n\treturn n\n}\n")])])]),n("ul",[n("li",[t._v("è‹¥æº Slice æˆ–ç›®æ ‡ Slice å­˜åœ¨é•¿åº¦ä¸º 0 çš„æƒ…å†µï¼Œåˆ™ç›´æ¥è¿”å› 0ï¼ˆå› ä¸ºå‹æ ¹ä¸éœ€è¦æ‰§è¡Œå¤åˆ¶è¡Œä¸ºï¼‰")]),t._v(" "),n("li",[t._v("é€šè¿‡å¯¹æ¯”ä¸¤ä¸ª Sliceï¼Œè·å–æœ€å°çš„ Slice é•¿åº¦ã€‚ä¾¿äºåç»­æ“ä½œ")]),t._v(" "),n("li",[t._v("è‹¥ Slice åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œåˆ™ç›´æ¥åˆ©ç”¨æŒ‡é’ˆçš„ç‰¹æ€§è¿›è¡Œè½¬æ¢")]),t._v(" "),n("li",[t._v("è‹¥ Slice å¤§äºä¸€ä¸ªå…ƒç´ ï¼Œåˆ™ä» "),n("code",[t._v("fm.array")]),t._v(" å¤åˆ¶ "),n("code",[t._v("size")]),t._v(" ä¸ªå­—èŠ‚åˆ° "),n("code",[t._v("to.array")]),t._v(" çš„åœ°å€å¤„ï¼ˆä¼šè¦†ç›–åŸæœ‰çš„å€¼ï¼‰")])]),t._v(" "),n("h2",{attrs:{id:"å¥‡ç‰¹-çš„åˆå§‹åŒ–"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å¥‡ç‰¹-çš„åˆå§‹åŒ–"}},[t._v("#")]),t._v(' "å¥‡ç‰¹"çš„åˆå§‹åŒ–')]),t._v(" "),n("p",[t._v("åœ¨ Slice ä¸­æµä¼ ç€ä¸¤ä¸ªä¼ è¯´ï¼Œåˆ†åˆ«æ˜¯ Empty å’Œ Nil Sliceï¼Œæ¥ä¸‹æ¥è®©æˆ‘ä»¬çœ‹çœ‹å®ƒä»¬çš„å°åŒºåˆ« ğŸ¤“")]),t._v(" "),n("h3",{attrs:{id:"empty"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#empty"}},[t._v("#")]),t._v(" Empty")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('func main() {\n\tnums := []int{}\n\trenums := make([]int, 0)\n\t\n\tfmt.Printf("nums: %v, len: %d, cap: %d\\n", nums, len(nums), cap(nums))\n\tfmt.Printf("renums: %v, len: %d, cap: %d\\n", renums, len(renums), cap(renums))\n}\n')])])]),n("p",[t._v("è¾“å‡ºç»“æœï¼š")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("nums: [], len: 0, cap: 0\nrenums: [], len: 0, cap: 0\n")])])]),n("h3",{attrs:{id:"nil"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nil"}},[t._v("#")]),t._v(" Nil")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("func main() {\n    var nums []int\n}\n")])])]),n("p",[t._v("è¾“å‡ºç»“æœï¼š")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("nums: [], len: 0, cap: 0\n")])])]),n("h3",{attrs:{id:"æƒ³ä¸€æƒ³"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#æƒ³ä¸€æƒ³"}},[t._v("#")]),t._v(" æƒ³ä¸€æƒ³")]),t._v(" "),n("p",[t._v("ä¹ä¸€çœ‹ï¼ŒEmpty Slice å’Œ Nil Slice å¥½åƒä¸€æ¨¡ä¸€æ ·ï¼Ÿä¸ç®¡æ˜¯ lenï¼Œè¿˜æ˜¯ cap éƒ½ä¸º 0ã€‚å¥½åƒæ²¡åŒºåˆ«ï¼Ÿæˆ‘ä»¬å†çœ‹çœ‹å¦‚ä¸‹ä»£ç ï¼š")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('func main() {\n\tvar nums []int\n\trenums := make([]int, 0)\n\tif nums == nil {\n\t\tfmt.Println("nums is nil.")\n\t}\n\tif renums == nil {\n\t\tfmt.Println("renums is nil.")\n\t}\n}\n')])])]),n("p",[t._v("ä½ è§‰å¾—è¾“å‡ºç»“æœæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä½ å¯èƒ½å·²ç»æƒ³åˆ°äº†ï¼Œæœ€ç»ˆçš„è¾“å‡ºç»“æœï¼š")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("nums is nil.\n")])])]),n("h4",{attrs:{id:"ä¸ºä»€ä¹ˆ"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ä¸ºä»€ä¹ˆ"}},[t._v("#")]),t._v(" ä¸ºä»€ä¹ˆ")]),t._v(" "),n("h5",{attrs:{id:"empty-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#empty-2"}},[t._v("#")]),t._v(" Empty")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://i.imgur.com/2DFo7H0.png",alt:"image"}})]),t._v(" "),n("h5",{attrs:{id:"nil-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nil-2"}},[t._v("#")]),t._v(" Nil")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://i.imgur.com/WClJnJZ.png",alt:"image"}})]),t._v(" "),n("p",[t._v("ä»å›¾ç¤ºä¸­å¯ä»¥çœ‹å‡ºæ¥ï¼Œä¸¤è€…æœ‰æœ¬è´¨ä¸Šçš„åŒºåˆ«ã€‚å…¶åº•å±‚æ•°ç»„çš„æŒ‡å‘æŒ‡é’ˆæ˜¯ä¸ä¸€æ ·çš„ï¼ŒNil Slice æŒ‡å‘çš„æ˜¯ nilï¼ŒEmpty Slice æŒ‡å‘çš„æ˜¯å®é™…å­˜åœ¨çš„ç©ºæ•°ç»„åœ°å€")]),t._v(" "),n("p",[t._v("ä½ å¯ä»¥è®¤ä¸ºï¼ŒNil Slice ä»£æŒ‡ä¸å­˜åœ¨çš„ Sliceï¼ŒEmpty Slice ä»£æŒ‡ç©ºé›†åˆã€‚ä¸¤è€…æ‰€ä»£è¡¨çš„æ„ä¹‰æ˜¯å®Œå…¨ä¸åŒçš„")]),t._v(" "),n("h2",{attrs:{id:"æ€»ç»“"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#æ€»ç»“"}},[t._v("#")]),t._v(" æ€»ç»“")]),t._v(" "),n("p",[t._v("é€šè¿‡æœ¬æ–‡ï¼Œå¯å¾—çŸ¥ Go Slice ç›¸å½“çµæ´»ã€‚ä¸éœ€è¦ä½ æ‰‹åŠ¨æ‰©å®¹ï¼Œä¹Ÿä¸éœ€è¦ä½ å…³æ³¨åŠ å¤šå°‘å‡å¤šå°‘ã€‚å¯¹ Array æ˜¯åŠ¨æ€å¼•ç”¨ï¼Œæ˜¯ Go ç±»å‹çš„ä¸€ä¸ªæå¤§çš„è¡¥å……ï¼Œä¹Ÿå› æ­¤åœ¨åº”ç”¨ä¸­ä½¿ç”¨çš„æ›´å¤šã€æ›´ä¾¿æ·")]),t._v(" "),n("p",[t._v("è™½ç„¶æœ‰ä¸ªåˆ«è¦æ³¨æ„çš„ â€œå‘â€ï¼Œä½†å…¶å®æ˜¯åˆç†çš„ã€‚ä½ è§‰å¾—å‘¢ï¼ŸğŸ˜„")])])}),[],!1,null,null,null);a.default=s.exports}}]);