(window.webpackJsonp=window.webpackJsonp||[]).push([[277],{855:function(t,n,a){"use strict";a.r(n);var e=a(44),r=Object(e.a)({},(function(){var t=this,n=t.$createElement,a=t._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"_1-6-æ¥ï¼Œæ§åˆ¶ä¸€ä¸‹-goroutine-çš„å¹¶å‘æ•°é‡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-æ¥ï¼Œæ§åˆ¶ä¸€ä¸‹-goroutine-çš„å¹¶å‘æ•°é‡"}},[t._v("#")]),t._v(" 1.6 æ¥ï¼Œæ§åˆ¶ä¸€ä¸‹ goroutine çš„å¹¶å‘æ•°é‡")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://i.imgur.com/dGQVT1x.jpg",alt:"image"}})]),t._v(" "),a("h2",{attrs:{id:"é—®é¢˜"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#é—®é¢˜"}},[t._v("#")]),t._v(" é—®é¢˜")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('func main() {\n\tuserCount := math.MaxInt64\n\tfor i := 0; i < userCount; i++ {\n\t\tgo func(i int) {\n\t\t    // åšä¸€äº›å„ç§å„æ ·çš„ä¸šåŠ¡é€»è¾‘å¤„ç†\n\t\t\tfmt.Printf("go func: %d\\n", i)\n\t\t\ttime.Sleep(time.Second)\n\t\t}(i)\n\t}\n}\n')])])]),a("p",[t._v("åœ¨è¿™é‡Œï¼Œå‡è®¾ "),a("code",[t._v("userCount")]),t._v(" æ˜¯ä¸€ä¸ªå¤–éƒ¨ä¼ å…¥çš„å‚æ•°ï¼ˆä¸å¯é¢„æµ‹ï¼Œæœ‰å¯èƒ½å€¼éå¸¸å¤§ï¼‰ï¼Œæœ‰äººä¼šå…¨éƒ¨ä¸¢è¿›å»å¾ªç¯ã€‚æƒ³ç€å…¨éƒ¨éƒ½å¹¶å‘ goroutine å»åŒæ—¶åšæŸä¸€ä»¶äº‹ã€‚è§‰å¾—è¿™æ ·å­ä¼šæ•ˆç‡ä¼šæ›´é«˜ï¼Œå¯¹ä¸å¯¹ï¼")]),t._v(" "),a("p",[t._v("é‚£ä¹ˆï¼Œä½ è§‰å¾—è¿™é‡Œæœ‰æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ")]),t._v(" "),a("h2",{attrs:{id:"å™©æ¢¦èˆ¬çš„å¼€å§‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å™©æ¢¦èˆ¬çš„å¼€å§‹"}},[t._v("#")]),t._v(" å™©æ¢¦èˆ¬çš„å¼€å§‹")]),t._v(" "),a("p",[t._v("å½“ç„¶ï¼Œåœ¨"),a("strong",[t._v("ç‰¹å®šåœºæ™¯ä¸‹")]),t._v("ï¼Œé—®é¢˜å¯å¤§äº†ã€‚å› ä¸ºåœ¨æœ¬æ–‡è¢«ä¸¢è¿›å»åŒæ—¶å¹¶å‘çš„å¯æ˜¯ä¸€ä¸ªæç«¯å€¼ã€‚æˆ‘ä»¬å¯ä»¥ä¸€èµ·è§‚å¯Ÿä¸‹å›¾çš„æŒ‡æ ‡åˆ†æï¼Œçœ‹çœ‹æƒ…å†µæœ‰å¤š â€œå´©æºƒâ€ã€‚ä¸‹å›¾æ˜¯ä¸Šè¿°ä»£ç çš„è¡¨ç°ï¼š")]),t._v(" "),a("h3",{attrs:{id:"è¾“å‡ºç»“æœ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#è¾“å‡ºç»“æœ"}},[t._v("#")]),t._v(" è¾“å‡ºç»“æœ")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("...\ngo func: 5839\ngo func: 5840\ngo func: 5841\ngo func: 5842\ngo func: 5915\ngo func: 5524\ngo func: 5916\ngo func: 8209\ngo func: 8264\nsignal: killed\n")])])]),a("p",[t._v("å¦‚æœä½ è‡ªå·±æ‰§è¡Œè¿‡ä»£ç ï¼Œåœ¨ â€œè¾“å‡ºç»“æœâ€ ä¸Šä½ ä¼šé‡åˆ°å¦‚ä¸‹é—®é¢˜ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("ç³»ç»Ÿèµ„æºå ç”¨ç‡ä¸æ–­ä¸Šæ¶¨")]),t._v(" "),a("li",[t._v("è¾“å‡ºä¸€å®šæ•°é‡åï¼šæ§åˆ¶å°å°±ä¸å†åˆ·æ–°è¾“å‡ºæœ€æ–°çš„å€¼äº†")]),t._v(" "),a("li",[t._v("ä¿¡å·é‡ï¼šsignal: killed")])]),t._v(" "),a("h3",{attrs:{id:"ç³»ç»Ÿè´Ÿè½½"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç³»ç»Ÿè´Ÿè½½"}},[t._v("#")]),t._v(" ç³»ç»Ÿè´Ÿè½½")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://i.imgur.com/bZjQ2ey.jpg",alt:"image"}})]),t._v(" "),a("h3",{attrs:{id:"cpu"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cpu"}},[t._v("#")]),t._v(" CPU")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://i.imgur.com/zxXSgaP.jpg",alt:"image"}})]),t._v(" "),a("p",[t._v("çŸ­æ—¶é—´å†…ç³»ç»Ÿè´Ÿè½½æš´å¢")]),t._v(" "),a("h3",{attrs:{id:"è™šæ‹Ÿå†…å­˜"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#è™šæ‹Ÿå†…å­˜"}},[t._v("#")]),t._v(" è™šæ‹Ÿå†…å­˜")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://i.imgur.com/xYZO9cE.jpg",alt:"image"}})]),t._v(" "),a("p",[t._v("çŸ­æ—¶é—´å†…å ç”¨çš„è™šæ‹Ÿå†…å­˜æš´å¢")]),t._v(" "),a("h3",{attrs:{id:"top"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#top"}},[t._v("#")]),t._v(" top")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("PID    COMMAND      %CPU  TIME     #TH   #WQ  #PORT MEM    PURG   CMPRS  PGRP  PPID  STATE    BOOSTS\n...\n73414  test         100.2 01:59.50 9/1   0    18    6801M+ 0B     114G+  73403 73403 running  *0[1]\n")])])]),a("h3",{attrs:{id:"å°ç»“"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å°ç»“"}},[t._v("#")]),t._v(" å°ç»“")]),t._v(" "),a("p",[t._v("å¦‚æœä»”ç»†çœ‹è¿‡ç›‘æ§å·¥å…·çš„ç¤ºæ„å›¾ï¼Œå°±å¯ä»¥çŸ¥é“å…¶å®æˆ‘é—´éš”çš„æ‰§è¡Œäº†ä¸¤æ¬¡ï¼Œèƒ½çœ‹åˆ°ç³»ç»Ÿé—´çš„ä½¿ç”¨ç‡å¹…åº¦éå¸¸å¤§ã€‚å½“è¿›ç¨‹è¢«æ€æ‰åï¼Œæ•´ä½“åˆæ¢å¤ä¸ºæ­£å¸¸å€¼")]),t._v(" "),a("p",[t._v("åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å›åˆ°ä¸»é¢˜ï¼Œå°±æ˜¯åœ¨"),a("strong",[t._v("ä¸æ§åˆ¶å¹¶å‘çš„ goroutine æ•°é‡")]),t._v(" ä¼šå‘ç”Ÿä»€ä¹ˆé—®é¢˜ï¼Ÿå¤§è‡´å¦‚ä¸‹ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("CPU ä½¿ç”¨ç‡æµ®åŠ¨ä¸Šæ¶¨")]),t._v(" "),a("li",[t._v("Memory å ç”¨ä¸æ–­ä¸Šæ¶¨ã€‚ä¹Ÿå¯ä»¥çœ‹çœ‹ CMPRSï¼Œå®ƒè¡¨ç¤ºè¿›ç¨‹çš„å‹ç¼©æ•°æ®çš„å­—èŠ‚æ•°ã€‚å·²ç»åˆ°è¾¾ 114G+ äº†")]),t._v(" "),a("li",[t._v("ä¸»è¿›ç¨‹å´©æºƒï¼ˆè¢«æ€æ‰äº†ï¼‰")])]),t._v(" "),a("p",[t._v("ç®€å•æ¥è¯´ï¼Œâ€œå´©æºƒâ€ çš„åŸå› å°±æ˜¯å¯¹ç³»ç»Ÿèµ„æºçš„å ç”¨è¿‡å¤§ã€‚å¸¸è§çš„æ¯”å¦‚ï¼šæ‰“å¼€æ–‡ä»¶æ•°ï¼ˆtoo many files openï¼‰ã€å†…å­˜å ç”¨ç­‰ç­‰")]),t._v(" "),a("h3",{attrs:{id:"å±å®³"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å±å®³"}},[t._v("#")]),t._v(" å±å®³")]),t._v(" "),a("p",[t._v("å¯¹è¯¥å°æœåŠ¡å™¨äº§ç”Ÿéå¸¸å¤§çš„å½±å“ï¼Œå½±å“è‡ªèº«åŠç›¸å…³è”çš„åº”ç”¨ã€‚å¾ˆæœ‰å¯èƒ½å¯¼è‡´ä¸å¯ç”¨æˆ–å“åº”ç¼“æ…¢ï¼Œå¦å¤–å¯åŠ¨äº†å¤æ•° â€œå¤±æ§â€ çš„ goroutineï¼Œå¯¼è‡´ç¨‹åºæµè½¬æ··ä¹±")]),t._v(" "),a("h2",{attrs:{id:"è§£å†³æ–¹æ¡ˆ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#è§£å†³æ–¹æ¡ˆ"}},[t._v("#")]),t._v(" è§£å†³æ–¹æ¡ˆ")]),t._v(" "),a("p",[t._v("åœ¨å‰é¢èŠ±äº†å¤§é‡ç¯‡å¹…ï¼Œæ¸²æŸ“äº†åœ¨å­˜åœ¨å¤§é‡å¹¶å‘ goroutine æ•°é‡æ—¶ï¼Œä¸æ§åˆ¶çš„è¯ä¼šå‡ºç° â€œä¸¥é‡â€ çš„é—®é¢˜ï¼Œæ¥ä¸‹æ¥ä¸€èµ·æ€è€ƒä¸‹è§£å†³æ–¹æ¡ˆã€‚å¦‚ä¸‹ï¼š")]),t._v(" "),a("ol",[a("li",[t._v("æ§åˆ¶/é™åˆ¶ goroutine åŒæ—¶å¹¶å‘è¿è¡Œçš„æ•°é‡")]),t._v(" "),a("li",[t._v("æ”¹å˜åº”ç”¨ç¨‹åºçš„é€»è¾‘å†™æ³•ï¼ˆé¿å…å¤§è§„æ¨¡çš„ä½¿ç”¨ç³»ç»Ÿèµ„æºå’Œç­‰å¾…ï¼‰")]),t._v(" "),a("li",[a("s",[t._v("è°ƒæ•´æœåŠ¡çš„ç¡¬ä»¶é…ç½®ã€æœ€å¤§æ‰“å¼€æ•°ã€å†…å­˜ç­‰é˜ˆå€¼")])])]),t._v(" "),a("h2",{attrs:{id:"æ§åˆ¶-goroutine-å¹¶å‘æ•°é‡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ§åˆ¶-goroutine-å¹¶å‘æ•°é‡"}},[t._v("#")]),t._v(" æ§åˆ¶ goroutine å¹¶å‘æ•°é‡")]),t._v(" "),a("p",[t._v("æ¥ä¸‹æ¥æ­£å¼çš„å¼€å§‹è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¸Œæœ›ä½ è®¤çœŸé˜…è¯»çš„åŒæ—¶åŠ ä»¥æ€è€ƒï¼Œå› ä¸ºè¿™ä¸ªé—®é¢˜åœ¨å®é™…é¡¹ç›®ä¸­çœŸçš„æ˜¯å¤ªå¸¸è§äº†ï¼")]),t._v(" "),a("p",[t._v("é—®é¢˜å·²ç»æŠ›å‡ºæ¥äº†ï¼Œä½ éœ€è¦åšçš„æ˜¯"),a("strong",[t._v("æƒ³æƒ³æœ‰ä»€ä¹ˆåŠæ³•")]),t._v("è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å»ºè®®ä½ è‡ªè¡Œæ€è€ƒä¸€ä¸‹æŠ€æœ¯æ–¹æ¡ˆã€‚å†æ¥ç€å¾€ä¸‹çœ‹ ğŸ˜ƒ")]),t._v(" "),a("h3",{attrs:{id:"å°è¯•-chan"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å°è¯•-chan"}},[t._v("#")]),t._v(" å°è¯• chan")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('func main() {\n\tuserCount := 10\n\tch := make(chan bool, 2)\n\tfor i := 0; i < userCount; i++ {\n\t\tch <- true\n\t\tgo Read(ch, i)\n\t}\n\t\n\t//time.Sleep(time.Second)\n}\n\nfunc Read(ch chan bool, i int) {\n\tfmt.Printf("go func: %d\\n", i)\n\t<- ch\n}\n')])])]),a("p",[t._v("è¾“å‡ºç»“æœï¼š")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("go func: 1\ngo func: 2\ngo func: 3\ngo func: 4\ngo func: 5\ngo func: 6\ngo func: 7\ngo func: 8\ngo func: 0\n")])])]),a("p",[t._v("å—¯ï¼Œæˆ‘ä»¬ä¼¼ä¹å¾ˆå¥½çš„æ§åˆ¶äº† 2 ä¸ª 2 ä¸ªçš„ â€œé¡ºåºâ€ æ‰§è¡Œå¤šä¸ª goroutineã€‚ä½†æ˜¯ï¼Œé—®é¢˜å‡ºç°äº†ã€‚ä½ ä»”ç»†æ•°ä¸€ä¸‹è¾“å‡ºç»“æœï¼Œæ‰ 9 ä¸ªå€¼ï¼Ÿ")]),t._v(" "),a("p",[t._v("è¿™æ˜æ˜¾å°±ä¸å¯¹ã€‚åŸå› å‡ºåœ¨å½“ä¸»åç¨‹ç»“æŸæ—¶ï¼Œå­åç¨‹ä¹Ÿæ˜¯ä¼šè¢«ç»ˆæ­¢æ‰çš„ã€‚å› æ­¤å‰©ä½™çš„ goroutine æ²¡æ¥åŠæŠŠå€¼è¾“å‡ºï¼Œå°±è¢«é€ä¸Šè·¯äº†ï¼ˆä¸ä¿¡ä½ æŠŠ "),a("code",[t._v("time.Sleep")]),t._v(" æ‰“å¼€çœ‹çœ‹ï¼Œçœ‹çœ‹è¾“å‡ºæ•°é‡ï¼‰")]),t._v(" "),a("h3",{attrs:{id:"å°è¯•-sync"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å°è¯•-sync"}},[t._v("#")]),t._v(" å°è¯• sync")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('...\nvar wg = sync.WaitGroup{}\n\nfunc main() {\n\tuserCount := 10\n\tfor i := 0; i < userCount; i++ {\n\t\twg.Add(1)\n\t\tgo Read(i)\n\t}\n\n\twg.Wait()\n}\n\nfunc Read(i int) {\n\tdefer wg.Done()\n\tfmt.Printf("go func: %d\\n", i)\n}\n')])])]),a("p",[t._v("å—¯ï¼Œå•çº¯çš„ä½¿ç”¨ "),a("code",[t._v("sync.WaitGroup")]),t._v(" ä¹Ÿä¸è¡Œã€‚æ²¡æœ‰æ§åˆ¶åˆ°åŒæ—¶å¹¶å‘çš„ goroutine æ•°é‡ï¼ˆä»£æŒ‡è¾¾ä¸åˆ°æœ¬æ–‡æ‰€è¦æ±‚çš„ç›®æ ‡ï¼‰")]),t._v(" "),a("h4",{attrs:{id:"å°ç»“-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å°ç»“-2"}},[t._v("#")]),t._v(" å°ç»“")]),t._v(" "),a("p",[t._v("å•çº¯"),a("strong",[t._v("ç®€å•")]),t._v("ä½¿ç”¨ channel æˆ– sync éƒ½æœ‰æ˜æ˜¾ç¼ºé™·ï¼Œä¸è¡Œã€‚æˆ‘ä»¬å†çœ‹çœ‹ç»„ä»¶é…åˆèƒ½ä¸èƒ½å®ç°")]),t._v(" "),a("h3",{attrs:{id:"å°è¯•-chan-sync"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å°è¯•-chan-sync"}},[t._v("#")]),t._v(" å°è¯• chan + sync")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('...\nvar wg = sync.WaitGroup{}\n\nfunc main() {\n\tuserCount := 10\n\tch := make(chan bool, 2)\n\tfor i := 0; i < userCount; i++ {\n\t\twg.Add(1)\n\t\tgo Read(ch, i)\n\t}\n\n\twg.Wait()\n}\n\nfunc Read(ch chan bool, i int) {\n\tdefer wg.Done()\n\n\tch <- true\n\tfmt.Printf("go func: %d, time: %d\\n", i, time.Now().Unix())\n\ttime.Sleep(time.Second)\n\t<-ch\n}\n')])])]),a("p",[t._v("è¾“å‡ºç»“æœï¼š")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("go func: 9, time: 1547911938\ngo func: 1, time: 1547911938\ngo func: 6, time: 1547911939\ngo func: 7, time: 1547911939\ngo func: 8, time: 1547911940\ngo func: 0, time: 1547911940\ngo func: 3, time: 1547911941\ngo func: 2, time: 1547911941\ngo func: 4, time: 1547911942\ngo func: 5, time: 1547911942\n")])])]),a("p",[t._v("ä»è¾“å‡ºç»“æœæ¥çœ‹ï¼Œç¡®å®å®ç°äº†æ§åˆ¶ goroutine ä»¥ 2 ä¸ª 2 ä¸ªçš„æ•°é‡å»æ‰§è¡Œæˆ‘ä»¬çš„ â€œä¸šåŠ¡é€»è¾‘â€ï¼Œå½“ç„¶ç»“æœé›†ä¹Ÿç†æ‰€åº”å½“çš„æ˜¯ä¹±åºè¾“å‡º")]),t._v(" "),a("h3",{attrs:{id:"æ–¹æ¡ˆä¸€ï¼šç®€å•-semaphore"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ–¹æ¡ˆä¸€ï¼šç®€å•-semaphore"}},[t._v("#")]),t._v(" æ–¹æ¡ˆä¸€ï¼šç®€å• Semaphore")]),t._v(" "),a("p",[t._v("åœ¨ç¡®ç«‹äº†ç®€å•ä½¿ç”¨ chan + sync çš„æ–¹æ¡ˆæ˜¯å¯è¡Œåï¼Œæˆ‘ä»¬é‡æ–°å°†æµè½¬é€»è¾‘å°è£…ä¸º "),a("a",{attrs:{href:"https://github.com/EDDYCJY/gsema",target:"_blank",rel:"noopener noreferrer"}},[t._v("gsema"),a("OutboundLink")],1),t._v("ï¼Œä¸»ç¨‹åºå˜æˆå¦‚ä¸‹ï¼š")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('import (\n\t"fmt"\n\t"time"\n\n\t"github.com/EDDYCJY/gsema"\n)\n\nvar sema = gsema.NewSemaphore(3)\n\nfunc main() {\n\tuserCount := 10\n\tfor i := 0; i < userCount; i++ {\n\t\tgo Read(i)\n\t}\n\n\tsema.Wait()\n}\n\nfunc Read(i int) {\n\tdefer sema.Done()\n\tsema.Add(1)\n\n\tfmt.Printf("go func: %d, time: %d\\n", i, time.Now().Unix())\n\ttime.Sleep(time.Second)\n}\n')])])]),a("h3",{attrs:{id:"åˆ†ææ–¹æ¡ˆ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åˆ†ææ–¹æ¡ˆ"}},[t._v("#")]),t._v(" åˆ†ææ–¹æ¡ˆ")]),t._v(" "),a("p",[t._v("åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œç¨‹åºæ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("è®¾ç½®å…è®¸çš„å¹¶å‘æ•°ç›®ä¸º 3 ä¸ª")]),t._v(" "),a("li",[t._v("å¾ªç¯ 10 æ¬¡ï¼Œæ¯æ¬¡å¯åŠ¨ä¸€ä¸ª goroutine æ¥æ‰§è¡Œä»»åŠ¡")]),t._v(" "),a("li",[t._v("æ¯ä¸€ä¸ª goroutine åœ¨å†…éƒ¨åˆ©ç”¨ "),a("code",[t._v("sema")]),t._v(" è¿›è¡Œè°ƒæ§æ˜¯å¦é˜»å¡")]),t._v(" "),a("li",[t._v("æŒ‰å…è®¸å¹¶å‘æ•°é€æ¸é‡Šå‡º goroutineï¼Œæœ€åç»“æŸä»»åŠ¡")])]),t._v(" "),a("p",[t._v("çœ‹ä¸Šå»äººæ¨¡äººæ ·ï¼Œæ²¡ä»€ä¹ˆä¸¥é‡é—®é¢˜ã€‚ä½†å´æœ‰ä¸€ä¸ª â€œå¤§â€ å‘ï¼Œè®¤çœŸçœ‹åˆ°ç¬¬äºŒç‚¹ â€œæ¯æ¬¡å¯åŠ¨ä¸€ä¸ª goroutineâ€ è¿™å¥è¯ã€‚è¿™é‡Œ"),a("strong",[t._v("æœ‰ç‚¹é—®é¢˜")]),t._v("ï¼Œæå‰äº§ç”Ÿé‚£ä¹ˆå¤šçš„ goroutine ä¼šä¸ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Œæ¥ä¸‹æ¥ä¸€èµ·åˆ†æä¸‹åˆ©å¼Šï¼Œå¦‚ä¸‹ï¼š")]),t._v(" "),a("h4",{attrs:{id:"åˆ©"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åˆ©"}},[t._v("#")]),t._v(" åˆ©")]),t._v(" "),a("ul",[a("li",[t._v("é€‚åˆ"),a("strong",[t._v("é‡ä¸å¤§ã€å¤æ‚åº¦ä½")]),t._v("çš„ä½¿ç”¨åœºæ™¯\n"),a("ul",[a("li",[t._v("å‡ ç™¾å‡ åƒä¸ªã€å‡ åä¸‡ä¸ªä¹Ÿæ˜¯å¯ä»¥æ¥å—çš„ï¼ˆçœ‹å…·ä½“ä¸šåŠ¡åœºæ™¯ï¼‰")]),t._v(" "),a("li",[t._v("å®é™…ä¸šåŠ¡é€»è¾‘åœ¨è¿è¡Œå‰å°±å·²ç»è¢«é˜»å¡ç­‰å¾…äº†ï¼ˆå› ä¸ºå¹¶å‘æ•°å—é™ï¼‰ï¼ŒåŸºæœ¬å®é™…ä¸šåŠ¡é€»è¾‘æŸè€—çš„æ€§èƒ½æ¯” goroutine æœ¬èº«å¤§")]),t._v(" "),a("li",[t._v("goroutine æœ¬èº«å¾ˆè½»ä¾¿ï¼Œä»…æŸè€—æå°‘è®¸çš„å†…å­˜ç©ºé—´å’Œè°ƒåº¦ã€‚è¿™ç§ç­‰å¾…å“åº”çš„æƒ…å†µéƒ½æ˜¯èººå¥½äº†ï¼Œç­‰å¾…ä»»åŠ¡å”¤é†’")])])]),t._v(" "),a("li",[t._v("Semaphore æ“ä½œå¤æ‚åº¦ä½ä¸”æµè½¬ç®€å•ï¼Œå®¹æ˜“æ§åˆ¶")])]),t._v(" "),a("h4",{attrs:{id:"å¼Š"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å¼Š"}},[t._v("#")]),t._v(" å¼Š")]),t._v(" "),a("ul",[a("li",[t._v("ä¸é€‚åˆ"),a("strong",[t._v("é‡å¾ˆå¤§ã€å¤æ‚åº¦é«˜")]),t._v("çš„ä½¿ç”¨åœºæ™¯\n"),a("ul",[a("li",[t._v("æœ‰å‡ ç™¾ä¸‡ã€å‡ åƒä¸‡ä¸ª goroutine çš„è¯ï¼Œå°±æµªè´¹äº†å¤§é‡è°ƒåº¦ goroutine å’Œå†…å­˜ç©ºé—´ã€‚æ°å¥½ä½ çš„æœåŠ¡å™¨ä¹Ÿæ¥å—ä¸äº†çš„è¯")])])]),t._v(" "),a("li",[t._v("Semaphore æ“ä½œå¤æ‚åº¦æé«˜ï¼Œè¦ç®¡ç†æ›´å¤šçš„çŠ¶æ€")])]),t._v(" "),a("h3",{attrs:{id:"å°ç»“-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å°ç»“-3"}},[t._v("#")]),t._v(" å°ç»“")]),t._v(" "),a("ul",[a("li",[t._v("åŸºäºä»€ä¹ˆä¸šåŠ¡åœºæ™¯ï¼Œå°±ç”¨ä»€ä¹ˆæ–¹æ¡ˆå»åšäº‹")]),t._v(" "),a("li",[t._v("æœ‰è¶³å¤Ÿçš„æ—¶é—´ï¼Œå…è®¸ä½ å»è¿½æ±‚æ›´ä¼˜ç§€ã€æè‡´çš„æ–¹æ¡ˆï¼ˆç”¨ç¬¬ä¸‰æ–¹åº“ä¹Ÿè¡Œï¼‰")])]),t._v(" "),a("p",[t._v("ç”¨å“ªç§æ–¹æ¡ˆï¼Œæˆ‘è®¤ä¸ºä¸»è¦åŸºäºä»¥ä¸Šä¸¤ç‚¹å»æ€è€ƒï¼Œéƒ½æ˜¯ OK çš„ã€‚æ²¡æœ‰å¯¹é”™ï¼Œåªæœ‰å½“å‰ä¸šåŠ¡åœºæ™¯èƒ½ä¸èƒ½æ¥å—ï¼Œè¿™ä¸ªé¢„å…ˆå¯åŠ¨çš„ goroutine æ•°é‡ä½ çš„ç³»ç»Ÿæ˜¯å¦èƒ½å¤Ÿæ¥å—")]),t._v(" "),a("p",[t._v("å½“ç„¶äº†ï¼Œå¸¸è§/ç®€å•çš„ Go åº”ç”¨é‡‡ç”¨è¿™ç±»æŠ€æœ¯æ–¹æ¡ˆï¼ŒåŸºæœ¬å°±èƒ½è§£å†³é—®é¢˜äº†ã€‚å› ä¸ºåƒæœ¬æ–‡ç¬¬ä¸€èŠ‚ â€œé—®é¢˜â€ å¦‚æ­¤è¶…å·¨å¤§æ•°é‡çš„æƒ…å†µï¼Œæƒ…å†µå¾ˆå°‘ã€‚å…¶å¹¶ä¸å­˜åœ¨é‚£äº› â€œç‰¹æ®Šæ€§â€ã€‚å› æ­¤ç”¨è¿™ä¸ªæ–¹æ¡ˆåŸºæœ¬ OK")]),t._v(" "),a("h2",{attrs:{id:"çµæ´»æ§åˆ¶-goroutine-å¹¶å‘æ•°é‡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#çµæ´»æ§åˆ¶-goroutine-å¹¶å‘æ•°é‡"}},[t._v("#")]),t._v(" çµæ´»æ§åˆ¶ goroutine å¹¶å‘æ•°é‡")]),t._v(" "),a("p",[t._v("å°æ‰‹ä¸€ç´§ã€‚éš”å£è€ç‹å‘ç°äº†æ–°çš„é—®é¢˜ã€‚â€œæ–¹æ¡ˆä¸€â€ ä¸­ï¼Œåœ¨"),a("strong",[t._v("è¾“å…¥è¾“å‡ºä¸€ä½“")]),t._v("çš„æƒ…å†µä¸‹ï¼Œåœ¨å¸¸è§çš„ä¸šåŠ¡åœºæ™¯ä¸­ç¡®å®å¯ä»¥")]),t._v(" "),a("p",[t._v("ä½†ï¼Œè¿™æ¬¡æ–°çš„ä¸šåŠ¡åœºæ™¯æ¯”è¾ƒç‰¹æ®Šï¼Œè¦æ§åˆ¶è¾“å…¥çš„æ•°é‡ï¼Œä»¥æ­¤è¾¾åˆ°"),a("strong",[t._v("æ”¹å˜å…è®¸å¹¶å‘è¿è¡Œ goroutine çš„æ•°é‡")]),t._v("ã€‚æˆ‘ä»¬ä»”ç»†æƒ³æƒ³ï¼Œè¦åšå‡ºå¦‚ä¸‹æ”¹å˜ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("è¾“å…¥/è¾“å‡ºè¦æŠ½ç¦»ï¼Œæ‰å¯ä»¥åˆ†åˆ«æ§åˆ¶")]),t._v(" "),a("li",[t._v("è¾“å…¥/è¾“å‡ºè¦å¯å˜ï¼Œç†æ‰€åº”å½“åœ¨ for-loop ä¸­ï¼ˆå¯è®¾ç½®æ•°å€¼çš„åœ°æ–¹ï¼‰")]),t._v(" "),a("li",[t._v("å…è®¸æ”¹å˜ goroutine å¹¶å‘æ•°é‡ï¼Œä½†å®ƒä¹Ÿå¿…é¡»æœ‰ä¸€ä¸ª"),a("strong",[t._v("æœ€å¤§å€¼")]),t._v("ï¼ˆå› ä¸ºå…è®¸æ”¹å˜æ˜¯ç›¸å¯¹ï¼‰")])]),t._v(" "),a("h3",{attrs:{id:"æ–¹æ¡ˆäºŒï¼šçµæ´»-chan-sync"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ–¹æ¡ˆäºŒï¼šçµæ´»-chan-sync"}},[t._v("#")]),t._v(" æ–¹æ¡ˆäºŒï¼šçµæ´» chan + sync")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('package main\n\nimport (\n\t"fmt"\n\t"sync"\n\t"time"\n)\n\nvar wg sync.WaitGroup\n\nfunc main() {\n\tuserCount := 10\n\tch := make(chan int, 5)\n\tfor i := 0; i < userCount; i++ {\n\t\twg.Add(1)\n\t\tgo func() {\n\t\t\tdefer wg.Done()\n\t\t\tfor d := range ch {\n\t\t\t\tfmt.Printf("go func: %d, time: %d\\n", d, time.Now().Unix())\n\t\t\t\ttime.Sleep(time.Second * time.Duration(d))\n\t\t\t}\n\t\t}()\n\t}\n\n\tfor i := 0; i < 10; i++ {\n\t\tch <- 1\n\t\tch <- 2\n\t\t//time.Sleep(time.Second)\n\t}\n\n\tclose(ch)\n\twg.Wait()\n}\n')])])]),a("p",[t._v("è¾“å‡ºç»“æœï¼š")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("...\ngo func: 1, time: 1547950567\ngo func: 3, time: 1547950567\ngo func: 1, time: 1547950567\ngo func: 2, time: 1547950567\ngo func: 2, time: 1547950567\ngo func: 3, time: 1547950567\ngo func: 1, time: 1547950568\ngo func: 2, time: 1547950568\ngo func: 3, time: 1547950568\ngo func: 1, time: 1547950568\ngo func: 3, time: 1547950569\ngo func: 2, time: 1547950569\n")])])]),a("p",[t._v("åœ¨ â€œæ–¹æ¡ˆäºŒâ€ ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥éšæ—¶éšåœ°çš„æ ¹æ®æ–°çš„ä¸šåŠ¡éœ€æ±‚ï¼Œåšå¦‚ä¸‹äº‹æƒ…ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("å˜æ›´ channel çš„è¾“å…¥æ•°é‡")]),t._v(" "),a("li",[t._v("èƒ½å¤Ÿæ ¹æ®ç‰¹æ®Šæƒ…å†µï¼Œå˜æ›´ channel çš„å¾ªç¯å€¼")]),t._v(" "),a("li",[t._v("å˜æ›´æœ€å¤§å…è®¸å¹¶å‘çš„ goroutine æ•°é‡")])]),t._v(" "),a("p",[t._v("æ€»çš„æ¥è¯´ï¼Œå°±æ˜¯å¯æ§ç©ºé—´éƒ½å°½é‡æ”¾å¼€äº†ï¼Œæ˜¯ä¸æ˜¯æ›´åŠ çµæ´»äº†å‘¢ ğŸ˜ƒ")]),t._v(" "),a("h3",{attrs:{id:"æ–¹æ¡ˆä¸‰ï¼šç¬¬ä¸‰æ–¹åº“"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ–¹æ¡ˆä¸‰ï¼šç¬¬ä¸‰æ–¹åº“"}},[t._v("#")]),t._v(" æ–¹æ¡ˆä¸‰ï¼šç¬¬ä¸‰æ–¹åº“")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/go-playground/pool",target:"_blank",rel:"noopener noreferrer"}},[t._v("go-playground/pool"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/nozzle/throttler",target:"_blank",rel:"noopener noreferrer"}},[t._v("nozzle/throttler"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/Jeffail/tunny",target:"_blank",rel:"noopener noreferrer"}},[t._v("Jeffail/tunny"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/panjf2000/ants",target:"_blank",rel:"noopener noreferrer"}},[t._v("panjf2000/ants"),a("OutboundLink")],1)])]),t._v(" "),a("p",[t._v("æ¯”è¾ƒæˆç†Ÿçš„ç¬¬ä¸‰æ–¹åº“ä¹Ÿä¸å°‘ï¼ŒåŸºæœ¬éƒ½æ˜¯ä»¥ç”Ÿæˆå’Œç®¡ç† goroutine ä¸ºç›®æ ‡çš„æ± å·¥å…·ã€‚æˆ‘ç®€å•åˆ—äº†å‡ ä¸ªï¼Œå…·ä½“å»ºè®®å¤§å®¶é˜…è¯»ä¸‹æºç æˆ–è€…å¤šæ‰¾æ‰¾ï¼ŒåŸç†ç›¸ä¼¼")]),t._v(" "),a("h2",{attrs:{id:"æ€»ç»“"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ€»ç»“"}},[t._v("#")]),t._v(" æ€»ç»“")]),t._v(" "),a("p",[t._v("åœ¨æœ¬æ–‡çš„å¼€å¤´ï¼Œæˆ‘èŠ±äº†å¤§åŠ›æ°”ï¼ˆæç«¯æ•°é‡ï¼‰ï¼Œå‘Šè¯‰ä½ "),a("strong",[t._v("åŒæ—¶å¹¶å‘è¿‡å¤šçš„ goroutine æ•°é‡ä¼šå¯¼è‡´ç³»ç»Ÿå ç”¨èµ„æºä¸æ–­ä¸Šæ¶¨ã€‚æœ€ç»ˆè¯¥æœåŠ¡å´©ç›˜çš„æç«¯æƒ…å†µ")]),t._v("ã€‚ä¸ºçš„æ˜¯å¸Œæœ›ä½ ä»Šåé¿å…è¿™ç§é—®é¢˜ï¼Œç»™ä½ ç•™ä¸‹æ·±åˆ»çš„å°è±¡")]),t._v(" "),a("p",[t._v("æ¥ä¸‹æ¥æˆ‘ä»¬ä»¥ â€œæ§åˆ¶ goroutine å¹¶å‘æ•°é‡â€ ä¸ºä¸»é¢˜ï¼Œå±•å¼€äº†ä¸€ç•ªåˆ†æã€‚åˆ†åˆ«ç»™å‡ºäº†ä¸‰ç§æ–¹æ¡ˆã€‚åœ¨æˆ‘çœ‹æ¥ï¼Œå„å…·ä¼˜ç¼ºç‚¹ï¼Œæˆ‘å»ºè®®ä½ "),a("strong",[t._v("æŒ‘é€‰åˆé€‚è‡ªèº«åœºæ™¯çš„æŠ€æœ¯æ–¹æ¡ˆ")]),t._v("å°±å¯ä»¥äº†")]),t._v(" "),a("p",[t._v("å› ä¸ºï¼Œæœ‰ä¸åŒç±»å‹çš„æŠ€æœ¯æ–¹æ¡ˆä¹Ÿèƒ½è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåƒäººåƒé¢ã€‚æœ¬æ–‡æ¨èçš„æ˜¯è¾ƒå¸¸è§çš„è§£å†³æ–¹æ¡ˆï¼Œä¹Ÿæ¬¢è¿å¤§å®¶åœ¨è¯„è®ºåŒºç»§ç»­è¡¥å…… ğŸ˜ƒ")])])}),[],!1,null,null,null);n.default=r.exports}}]);