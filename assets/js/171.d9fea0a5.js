(window.webpackJsonp=window.webpackJsonp||[]).push([[171],{725:function(t,a,s){"use strict";s.r(a);var n=s(44),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"_8-kafka集群部署"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-kafka集群部署"}},[t._v("#")]),t._v(" 8. kafka集群部署")]),t._v(" "),s("h3",{attrs:{id:"_8-1-准备工作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-1-准备工作"}},[t._v("#")]),t._v(" 8.1 准备工作")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[t._v("名称")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("IP地址")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("Hostname")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("组织结构")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("zk1")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.247.101")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("zookeeper1")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("zk2")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.247.102")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("zookeeper2")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("zk3")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.247.103")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("zookeeper3")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("kafka1")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.247.201")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("kafka1")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("kafka2")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.247.202")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("kafka2")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("kafka3")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.247.203")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("kafka3")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("kafka4")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.247.204")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("kafka4")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("orderer0")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.247.91")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("orderer0.test.com")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("orderer1")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.247.92")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("orderer1.test.com")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("orderer2")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.247.93")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("orderer2.test.com")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("peer0")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.247.81")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("peer0.orggo.test.com")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("OrgGo")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("peer0")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("192.168.247.82")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("peer0.orgcpp.test.com")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("OrgCpp")])])])]),t._v(" "),s("p",[t._v("为了保证整个集群的正常工作, 需要给集群中的各个节点设置工作目录, 我们要保证各个节点工作目录是相同的")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 在以上各个节点的家目录创建工作目录:")]),t._v("\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" ~/kafka\n")])])]),s("h3",{attrs:{id:"_8-2-生成证书文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-2-生成证书文件"}},[t._v("#")]),t._v(" 8.2. 生成证书文件")]),t._v(" "),s("h4",{attrs:{id:"_8-2-1-编写配置文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-2-1-编写配置文件"}},[t._v("#")]),t._v(" 8.2.1 编写配置文件")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# crypto-config.yaml")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("OrdererOrgs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Orderer\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Domain")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" test.com\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Specs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Hostname")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" orderer0\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 第1个排序节点: orderer0.test.com")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Hostname")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" orderer1\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 第2个排序节点: orderer1.test.com")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Hostname")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" orderer2  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 第3个排序节点: orderer2.test.com")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("PeerOrgs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" OrgGo\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Domain")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" orggo.test.com\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Count")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 当前go组织两个peer节点")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Users")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Count")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" OrgCpp\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Domain")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" orgcpp.test.com\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Count")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 当前cpp组织两个peer节点")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Users")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Count")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n")])])]),s("h4",{attrs:{id:"_8-2-2-生成证书"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-2-2-生成证书"}},[t._v("#")]),t._v(" 8.2.2 生成证书")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ cryptogen generate --config"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("crypto-config.yaml\n$ tree ./ -L "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n./\n├── "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),t._v("crypto-config"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("   -"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" 证书文件目录\n└── crypto-config.yaml\n")])])]),s("h3",{attrs:{id:"_8-3-生成创始块和通道文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-3-生成创始块和通道文件"}},[t._v("#")]),t._v(" 8.3. 生成创始块和通道文件")]),t._v(" "),s("h4",{attrs:{id:"_8-3-1-编写配置文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-3-1-编写配置文件"}},[t._v("#")]),t._v(" 8.3.1 编写配置文件")]),t._v(" "),s("blockquote",[s("p",[t._v("配置文件名"),s("code",[t._v("configtx.yaml")]),t._v("这个名字是固定的, 不可修改的")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("---")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("################################################################################")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#   Section: Organizations")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#   - This section defines the different organizational identities which will")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#   be referenced later in the configuration.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("################################################################################")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Organizations")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("&OrdererOrg")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" OrdererOrg\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ID")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" OrdererMSP\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("MSPDir")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" crypto"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("config/ordererOrganizations/test.com/msp\n\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("&go_org")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" OrgGoMSP\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ID")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" OrgGoMSP\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("MSPDir")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" crypto"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("config/peerOrganizations/orggo.test.com/msp\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("AnchorPeers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Host")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" peer0.orggo.test.com\n              "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Port")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7051")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("&cpp_org")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" OrgCppMSP\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ID")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" OrgCppMSP\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("MSPDir")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" crypto"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("config/peerOrganizations/orgcpp.test.com/msp\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("AnchorPeers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Host")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" peer0.orgcpp.test.com\n              "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Port")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7051")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("################################################################################")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#   SECTION: Capabilities")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("################################################################################")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Capabilities")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Global")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("&ChannelCapabilities")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("V1_1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Orderer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("&OrdererCapabilities")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("V1_1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Application")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("&ApplicationCapabilities")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("V1_2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("################################################################################")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#   SECTION: Application")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("################################################################################")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Application")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("&ApplicationDefaults")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Organizations")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("################################################################################")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#   SECTION: Orderer")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("################################################################################")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Orderer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("&OrdererDefaults")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# Available types are "solo" and "kafka"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("OrdererType")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" kafka\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Addresses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 排序节点服务器地址")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" orderer0.test.com"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7050")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" orderer1.test.com"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7050")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" orderer2.test.com"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7050")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("BatchTimeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 2s\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("BatchSize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("MaxMessageCount")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("AbsoluteMaxBytes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 99 MB\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("PreferredMaxBytes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 512 KB\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Kafka")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Brokers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" \n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# kafka服务器地址")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 192.168.247.201"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9092")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 192.168.247.202"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9092")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 192.168.247.203"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9092")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 192.168.247.204"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9092")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Organizations")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("################################################################################")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#   Profile")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("################################################################################")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Profiles")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("OrgsOrdererGenesis")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Capabilities")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("<<")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("*ChannelCapabilities")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Orderer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("<<")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("*OrdererDefaults")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Organizations")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("*OrdererOrg")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Capabilities")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("<<")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("*OrdererCapabilities")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Consortiums")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("SampleConsortium")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Organizations")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n                    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("*go_org")]),t._v("\n                    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("*cpp_org")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("OrgsChannel")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Consortium")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" SampleConsortium\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Application")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("<<")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("*ApplicationDefaults")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Organizations")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("*go_org")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("*cpp_org")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Capabilities")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("<<")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("*ApplicationCapabilities")]),t._v("\n")])])]),s("h4",{attrs:{id:"_8-3-2-生成通道和创始块文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-3-2-生成通道和创始块文件"}},[t._v("#")]),t._v(" 8.3.2 生成通道和创始块文件")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("生成创始块文件")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 我们先创建一个目录 channel-artifacts 存储生成的文件, 目的是为了和后边的配置文件模板的配置项保持一致")]),t._v("\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" channel-artifacts\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 生成通道文件")]),t._v("\n$ configtxgen -profile OrgsOrdererGenesis -outputBlock ./channel-artifacts/genesis.block\n")])])])]),t._v(" "),s("li",[s("p",[t._v("生成通道文件")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 生成创始块文件")]),t._v("\n$ configtxgen -profile OrgsChannel -outputCreateChannelTx ./channel-artifacts/channel.tx -channelID testchannel\n")])])])])]),t._v(" "),s("h3",{attrs:{id:"_8-4-zookeeper设置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-4-zookeeper设置"}},[t._v("#")]),t._v(" 8.4. Zookeeper设置")]),t._v(" "),s("h4",{attrs:{id:"_8-4-1-基本概念"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-4-1-基本概念"}},[t._v("#")]),t._v(" 8.4.1 基本概念")]),t._v(" "),s("blockquote",[s("p",[t._v("Zookeeper一种在分布式系统中被广泛用来作为分布式状态管理、分布式协调管理、分布式配置管理和分布式锁服务的集群。")])]),t._v(" "),s("ul",[s("li",[s("p",[t._v("zookeeper 的运作流程")]),t._v(" "),s("blockquote",[s("p",[t._v("在配置之前, 让我们先了解一下 "),s("code",[t._v("Zookeeper")]),t._v(" 的基本运转流程:")]),t._v(" "),s("ul",[s("li",[s("font",{attrs:{color:"red"}},[t._v("选举Leader")]),t._v(" "),s("ul",[s("li",[t._v("选举Leader过程中算法有很多，但要达到的选举标准是一致的")]),t._v(" "),s("li",[t._v("Leader要具有最高的执行ID，类似root权限。")]),t._v(" "),s("li",[t._v("集群中大多数的机器得到响应并跟随选出的Leader。")])])],1),t._v(" "),s("li",[s("font",{attrs:{color:"red"}},[t._v("数据同步")])],1)])])]),t._v(" "),s("li",[s("p",[t._v("Zookeeper的集群数量")]),t._v(" "),s("blockquote",[s("p",[t._v("Zookeeper 集群的数量可以是 "),s("code",[t._v("3, 5, 7,")]),t._v(" 它值需要是一个奇数以避免脑裂问题（split-brain）的情况。同时选择大于1的值是为了避免单点故障，如果集群的数量超过7个Zookeeper服务将会无法承受。")])])])]),t._v(" "),s("h4",{attrs:{id:"_8-4-2-zookeeper配置文件模板"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-4-2-zookeeper配置文件模板"}},[t._v("#")]),t._v(" 8.4.2 zookeeper配置文件模板")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("配置文件模板")]),t._v(" "),s("blockquote",[s("p",[t._v("下面我们来看一个示例配置文件, 研究下zookeeper如何配置:")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("zookeeper1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 服务器名, 自己起")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" zookeeper1 "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 容器名, 自己起")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("hostname")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" zookeeper1\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 访问的主机名, 自己起, 需要和IP有对应关系")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" hyperledger/fabric"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("zookeeper"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("latest\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restart")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" always\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定为always")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ID在集合中必须是唯一的并且应该有一个值，在1和255之间。")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ZOO_MY_ID=1\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# server.x=hostname:prot1:port2")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ZOO_SERVERS=server.1=zookeeper1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("2888"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("3888 server.2=zookeeper2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("2888"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("3888 server.3=zookeeper3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("2888"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3888")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 2181"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2181")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 2888"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2888")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 3888"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3888")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("extra_hosts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" zookeeper1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.24.201\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" zookeeper2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.24.202\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" zookeeper3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.24.203\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.24.204\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.24.205\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.24.206\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.24.207\n")])])])]),t._v(" "),s("li",[s("p",[t._v("相关配置项解释:")]),t._v(" "),s("blockquote",[s("ol",[s("li",[s("p",[t._v("docker 的"),s("code",[t._v("restart")]),t._v("策略")]),t._v(" "),s("ul",[s("li",[t._v("no – 容器退出时不要自动重启，这个是默认值。")]),t._v(" "),s("li",[t._v("on-failure[:max-retries] – 只在容器以非0状态码退出时重启， 例如："),s("code",[t._v("on-failure:10")])]),t._v(" "),s("li",[s("strong",[t._v("always")]),t._v(" – 不管退出状态码是什么始终重启容器")]),t._v(" "),s("li",[t._v("unless-"),s("a",{attrs:{href:"https://www.centos.bz/tag/stopped/",target:"_blank",rel:"noopener noreferrer"}},[t._v("stopped"),s("OutboundLink")],1),t._v(" – 不管退出状态码是什么始终重启容器，不过当daemon启动时，如果容器之前已经为停止状态，不要尝试启动它。")])])]),t._v(" "),s("li",[s("p",[t._v("环境变量")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("ZOO_MY_ID")]),t._v(" "),s("p",[t._v("zookeeper集群中的当前zookeeper服务器节点的ID, "),s("font",{attrs:{color:"red"}},[t._v("在集群中这个只是唯一的, 范围: 1-255")])],1)]),t._v(" "),s("li",[s("p",[t._v("ZOO_SERVERS")]),t._v(" "),s("ul",[s("li",[t._v("组成zookeeper集群的服务器列表")]),t._v(" "),s("li",[t._v("列表中每个服务器的值都附带两个端口号\n"),s("ul",[s("li",[s("font",{attrs:{color:"red"}},[t._v("第一个: 追随者用来连接 Leader 使用的")])],1),t._v(" "),s("li",[s("font",{attrs:{color:"red"}},[t._v("第二个: 用户选举 Leader")])],1)])])])])])]),t._v(" "),s("li",[s("p",[t._v("zookeeper服务器中三个重要端口:")]),t._v(" "),s("ul",[s("li",[t._v("访问zookeeper的端口: 2181")]),t._v(" "),s("li",[t._v("zookeeper集群中追随者连接 Leader 的端口: 2888")]),t._v(" "),s("li",[t._v("zookeeper集群中选举 Leader 的端口: 3888")])])]),t._v(" "),s("li",[s("p",[t._v("extra_hosts")]),t._v(" "),s("ul",[s("li",[t._v("设置服务器名和其指向的IP地址的对应关系")]),t._v(" "),s("li",[s("code",[t._v("zookeeper1:192.168.24.201")]),t._v(" "),s("ul",[s("li",[t._v("看到名字"),s("code",[t._v("zookeeper1")]),t._v("就会将其解析为IP地址: "),s("code",[t._v("192.168.24.201")])])])])])])])])])]),t._v(" "),s("h4",{attrs:{id:"_8-4-3-各个zookeeper节点的配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-4-3-各个zookeeper节点的配置"}},[t._v("#")]),t._v(" 8.4.3 各个zookeeper节点的配置")]),t._v(" "),s("h5",{attrs:{id:"zookeeper1-配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper1-配置"}},[t._v("#")]),t._v(" "),s("strong",[t._v("zookeeper1 配置")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# zookeeper1.yaml")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("zookeeper1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" zookeeper1\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("hostname")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" zookeeper1\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" hyperledger/fabric"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("zookeeper"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("latest\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restart")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" always\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ID在集合中必须是唯一的并且应该有一个值，在1和255之间。")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ZOO_MY_ID=1\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# server.x=[hostname]:nnnnn[:nnnnn]")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ZOO_SERVERS=server.1=zookeeper1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("2888"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("3888 server.2=zookeeper2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("2888"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("3888 server.3=zookeeper3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("2888"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3888")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 2181"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2181")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 2888"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2888")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 3888"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3888")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("extra_hosts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" zookeeper1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.101\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" zookeeper2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.102\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" zookeeper3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.103\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.201\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.202\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.203\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.204\n")])])]),s("h5",{attrs:{id:"zookeeper2-配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper2-配置"}},[t._v("#")]),t._v(" "),s("strong",[t._v("zookeeper2 配置")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# zookeeper2.yaml")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("zookeeper2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" zookeeper2\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("hostname")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" zookeeper2\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" hyperledger/fabric"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("zookeeper"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("latest\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restart")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" always\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ID在集合中必须是唯一的并且应该有一个值，在1和255之间。")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ZOO_MY_ID=2\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# server.x=[hostname]:nnnnn[:nnnnn]")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ZOO_SERVERS=server.1=zookeeper1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("2888"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("3888 server.2=zookeeper2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("2888"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("3888 server.3=zookeeper3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("2888"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3888")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 2181"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2181")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 2888"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2888")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 3888"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3888")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("extra_hosts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" zookeeper1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.101\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" zookeeper2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.102\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" zookeeper3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.103\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.201\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.202\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.203\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.204\n")])])]),s("h5",{attrs:{id:"zookeeper3-配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper3-配置"}},[t._v("#")]),t._v(" "),s("strong",[t._v("zookeeper3 配置")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# zookeeper3.yaml")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("zookeeper3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" zookeeper3\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("hostname")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" zookeeper3\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" hyperledger/fabric"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("zookeeper"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("latest\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restart")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" always\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ID在集合中必须是唯一的并且应该有一个值，在1和255之间。")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ZOO_MY_ID=3\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# server.x=[hostname]:nnnnn[:nnnnn]")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ZOO_SERVERS=server.1=zookeeper1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("2888"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("3888 server.2=zookeeper2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("2888"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("3888 server.3=zookeeper3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("2888"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3888")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 2181"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2181")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 2888"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2888")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 3888"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3888")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("extra_hosts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" zookeeper1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.101\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" zookeeper2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.102\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" zookeeper3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.103\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.201\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.202\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.203\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.204\n")])])]),s("h3",{attrs:{id:"_8-5-kafka设置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-5-kafka设置"}},[t._v("#")]),t._v(" 8.5. Kafka设置")]),t._v(" "),s("h4",{attrs:{id:"_8-5-1-基本概念"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-5-1-基本概念"}},[t._v("#")]),t._v(" 8.5.1 基本概念")]),t._v(" "),s("blockquote",[s("p",[t._v("Katka是一个分布式消息系统，由LinkedIn使用scala编写，用作LinkedIn的活动流（Activitystream)和运营数据处理管道（Pipeline）的基础。具有高水平扩展和高吞吐量。")]),t._v(" "),s("p",[t._v("在Fabric网络中，数据是由Peer节点提交到Orderer排序服务，而Orderer相对于Kafka来说相当于上游模块，且Orderer还兼具提供了对数据进行排序及生成符合配置规范及要求的区块。而使用上游模块的数据计算、统计、分析，这个时候就可以使用类似于Kafka这样的分布式消息系统来协助业务流程。")]),t._v(" "),s("p",[t._v("有人说Kafka是一种共识模式，也就是说平等信任，所有的HyperLedger Fabric网络加盟方都是可信方，因为消息总是均匀地分布在各处。但具体生产使用的时候是依赖于背书来做到确权，相对而言，Kafka应该只能是一种启动Fabric网络的模式或类型。")]),t._v(" "),s("p",[t._v("Zookeeper一种在分布式系统中被广泛用来作为分布式状态管理、分布式协调管理、分布式配置管理和分布式锁服务的集群。Kafka增加和减少服务器都会在Zookeeper节点上触发相应的事件，Kafka系统会捕获这些事件，进行新一轮的负载均衡，客户端也会捕获这些事件来进行新一轮的处理。")]),t._v(" "),s("p",[t._v("Orderer排序服务是Fablic网络事务流中的最重要的环节，也是所有请求的点，它并不会立刻对请求给予回馈，一是因为生成区块的条件所限，二是因为依托下游集群的消息处理需要等待结果。")])]),t._v(" "),s("h4",{attrs:{id:"_8-5-2-kafka配置文件模板"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-5-2-kafka配置文件模板"}},[t._v("#")]),t._v(" 8.5.2 kafka配置文件模板")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("kafka配置文件模板")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kafka1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" kafka1\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("hostname")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" kafka1\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" hyperledger/fabric"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("kafka"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("latest\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restart")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" always\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# broker.id")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_BROKER_ID=1\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_MIN_INSYNC_REPLICAS=2\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_DEFAULT_REPLICATION_FACTOR=3\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_ZOOKEEPER_CONNECT=zookeeper1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2181")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("zookeeper2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2181")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("zookeeper3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2181")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 99 * 1024 * 1024 B")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_MESSAGE_MAX_BYTES=103809024 \n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_REPLICA_FETCH_MAX_BYTES=103809024 "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 99 * 1024 * 1024 B")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_UNCLEAN_LEADER_ELECTION_ENABLE=false\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_LOG_RETENTION_MS="),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_HEAP_OPTS="),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Xmx256M "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Xms128M\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 9092"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9092")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("extra_hosts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"zookeeper1:192.168.24.201"')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" zookeeper2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.24.202\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" zookeeper3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.24.203\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.24.204\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.24.205\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.24.206\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.24.207\n")])])])]),t._v(" "),s("li",[s("p",[t._v("配置项解释")]),t._v(" "),s("blockquote",[s("ol",[s("li",[t._v("Kafka 默认端口为: 9092")]),t._v(" "),s("li",[t._v("环境变量:")])]),t._v(" "),s("ul",[s("li",[t._v("KAFKA_BROKER_ID\n"),s("ul",[s("li",[t._v("是一个唯一的非负整数, 可以作为代理"),s("code",[t._v("Broker")]),t._v("的名字")])])]),t._v(" "),s("li",[t._v("KAFKA_MIN_INSYNC_REPLICAS\n"),s("ul",[s("li",[t._v("最小同步备份")]),t._v(" "),s("li",[s("font",{attrs:{color:"red"}},[t._v("该值要小于环境变量 "),s("code",[t._v("KAFKA_DEFAULT_REPLICATION_FACTOR")]),t._v("的值")])],1)])]),t._v(" "),s("li",[t._v("KAFKA_DEFAULT_REPLICATION_FACTOR\n"),s("ul",[s("li",[t._v("默认同步备份, "),s("font",{attrs:{color:"red"}},[t._v("该值要小于kafka集群数量")])],1)])]),t._v(" "),s("li",[t._v("KAFKA_ZOOKEEPER_CONNECT\n"),s("ul",[s("li",[t._v("指向zookeeper节点的集合")])])]),t._v(" "),s("li",[t._v("KAFKA_MESSAGE_MAX_BYTES\n"),s("ul",[s("li",[t._v("消息的最大字节数")]),t._v(" "),s("li",[t._v("和配置文件"),s("code",[t._v("configtx.yaml")]),t._v("中的"),s("code",[t._v("Orderer.BatchSize.AbsoluteMaxBytes")]),t._v("对应")]),t._v(" "),s("li",[t._v("由于消息都有头信息, 所以这个值要比计算出的值稍大, "),s("code",[t._v("多加1M就足够了")])])])]),t._v(" "),s("li",[t._v("KAFKA_REPLICA_FETCH_MAX_BYTES=103809024\n"),s("ul",[s("li",[t._v("副本最大字节数, 试图为每个channel获取的消息的字节数")]),t._v(" "),s("li",[s("code",[t._v("AbsoluteMaxBytes")]),t._v("<"),s("code",[t._v("KAFKA_REPLICA_FETCH_MAX_BYTES")]),t._v(" <= "),s("code",[t._v("KAFKA_MESSAGE_MAX_BYTES")])])])]),t._v(" "),s("li",[t._v("KAFKA_UNCLEAN_LEADER_ELECTION_ENABLE=false\n"),s("ul",[s("li",[t._v("非一致性的 Leader 选举\n"),s("ul",[s("li",[t._v("开启: true")]),t._v(" "),s("li",[t._v("关闭: false")])])])])]),t._v(" "),s("li",[t._v("KAFKA_LOG_RETENTION_MS=-1\n"),s("ul",[s("li",[t._v("对压缩日志保留的最长时间")]),t._v(" "),s("li",[t._v("这个选项在Kafka中已经默认关闭")])])]),t._v(" "),s("li",[t._v("KAFKA_HEAP_OPTS\n"),s("ul",[s("li",[t._v("设置堆内存大小, "),s("font",{attrs:{color:"red"}},[t._v("kafka默认为 1G")]),t._v(" "),s("ul",[s("li",[t._v("-Xmx256M  -> 允许分配的堆内存")]),t._v(" "),s("li",[t._v("-Xms128M  ->  初始分配的堆内存")])])],1)])])])])])]),t._v(" "),s("h4",{attrs:{id:"_8-5-3-各个kafka节点的配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-5-3-各个kafka节点的配置"}},[t._v("#")]),t._v(" 8.5.3 各个kafka节点的配置")]),t._v(" "),s("h5",{attrs:{id:"kafka1-配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kafka1-配置"}},[t._v("#")]),t._v(" kafka1 配置")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# kafka1.yaml")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kafka1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" kafka1\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("hostname")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" kafka1\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" hyperledger/fabric"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("kafka"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("latest\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restart")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" always\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# broker.id")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_BROKER_ID=1\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_MIN_INSYNC_REPLICAS=2\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_DEFAULT_REPLICATION_FACTOR=3\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_ZOOKEEPER_CONNECT=zookeeper1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2181")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("zookeeper2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2181")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("zookeeper3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2181")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 100 * 1024 * 1024 B")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_MESSAGE_MAX_BYTES=104857600 \n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_REPLICA_FETCH_MAX_BYTES=104857600\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_UNCLEAN_LEADER_ELECTION_ENABLE=false\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_LOG_RETENTION_MS="),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_HEAP_OPTS="),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Xmx512M "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Xms256M\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 9092"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9092")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("extra_hosts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" zookeeper1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.101\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" zookeeper2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.102\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" zookeeper3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.103\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.201\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.202\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.203\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.204\n")])])]),s("h5",{attrs:{id:"kafka2-配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kafka2-配置"}},[t._v("#")]),t._v(" kafka2 配置")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# kafka2.yaml")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kafka2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" kafka2\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("hostname")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" kafka2\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" hyperledger/fabric"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("kafka"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("latest\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restart")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" always\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# broker.id")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_BROKER_ID=2\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_MIN_INSYNC_REPLICAS=2\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_DEFAULT_REPLICATION_FACTOR=3\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_ZOOKEEPER_CONNECT=zookeeper1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2181")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("zookeeper2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2181")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("zookeeper3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2181")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 100 * 1024 * 1024 B")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_MESSAGE_MAX_BYTES=104857600 \n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_REPLICA_FETCH_MAX_BYTES=104857600\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_UNCLEAN_LEADER_ELECTION_ENABLE=false\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_LOG_RETENTION_MS="),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_HEAP_OPTS="),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Xmx512M "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Xms256M\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 9092"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9092")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("extra_hosts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" zookeeper1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.101\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" zookeeper2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.102\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" zookeeper3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.103\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.201\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.202\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.203\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.204\n")])])]),s("h5",{attrs:{id:"kafka3-配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kafka3-配置"}},[t._v("#")]),t._v(" kafka3 配置")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# kafka3.yaml")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kafka3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" kafka3\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("hostname")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" kafka3\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" hyperledger/fabric"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("kafka"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("latest\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restart")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" always\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# broker.id")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_BROKER_ID=3\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_MIN_INSYNC_REPLICAS=2\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_DEFAULT_REPLICATION_FACTOR=3\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_ZOOKEEPER_CONNECT=zookeeper1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2181")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("zookeeper2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2181")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("zookeeper3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2181")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 100 * 1024 * 1024 B")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_MESSAGE_MAX_BYTES=104857600 \n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_REPLICA_FETCH_MAX_BYTES=104857600\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_UNCLEAN_LEADER_ELECTION_ENABLE=false\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_LOG_RETENTION_MS="),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_HEAP_OPTS="),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Xmx512M "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Xms256M\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 9092"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9092")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("extra_hosts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" zookeeper1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.101\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" zookeeper2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.102\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" zookeeper3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.103\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.201\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.202\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.203\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.204\n")])])]),s("h5",{attrs:{id:"kafka4-配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kafka4-配置"}},[t._v("#")]),t._v(" kafka4 配置")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# kafka4.yaml")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kafka4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" kafka4\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("hostname")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" kafka4\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" hyperledger/fabric"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("kafka"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("latest\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restart")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" always\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# broker.id")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_BROKER_ID=4\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_MIN_INSYNC_REPLICAS=2\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_DEFAULT_REPLICATION_FACTOR=3\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_ZOOKEEPER_CONNECT=zookeeper1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2181")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("zookeeper2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2181")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("zookeeper3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2181")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 100 * 1024 * 1024 B")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_MESSAGE_MAX_BYTES=104857600 \n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_REPLICA_FETCH_MAX_BYTES=104857600\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_UNCLEAN_LEADER_ELECTION_ENABLE=false\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_LOG_RETENTION_MS="),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" KAFKA_HEAP_OPTS="),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Xmx512M "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Xms256M\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 9092"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9092")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("extra_hosts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" zookeeper1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.101\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" zookeeper2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.102\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" zookeeper3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.103\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.201\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.202\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.203\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.204\n")])])]),s("h3",{attrs:{id:"_8-6-orderer节点设置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-6-orderer节点设置"}},[t._v("#")]),t._v(" 8.6. orderer节点设置")]),t._v(" "),s("h4",{attrs:{id:"_8-6-1-orderer节点配置文件模板"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-6-1-orderer节点配置文件模板"}},[t._v("#")]),t._v(" 8.6.1 orderer节点配置文件模板")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("orderer节点配置文件模板")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("orderer0.example.com")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" orderer0.example.com\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" hyperledger/fabric"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("orderer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("latest\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=aberic_default\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_LOGLEVEL=debug\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_LISTENADDRESS=0.0.0.0\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_LISTENPORT=7050\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_GENESISMETHOD=file\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_GENESISFILE=/var/hyperledger/orderer/orderer.genesis.block\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_LOCALMSPID=OrdererMSP\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_LOCALMSPDIR=/var/hyperledger/orderer/msp\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# enabled TLS")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_TLS_ENABLED=false\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_TLS_PRIVATEKEY=/var/hyperledger/orderer/tls/server.key\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_TLS_CERTIFICATE=/var/hyperledger/orderer/tls/server.crt\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_TLS_ROOTCAS="),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("/var/hyperledger/orderer/tls/ca.crt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n      \n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_KAFKA_RETRY_LONGINTERVAL=10s\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_KAFKA_RETRY_LONGTOTAL=100s\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_KAFKA_RETRY_SHORTINTERVAL=1s\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_KAFKA_RETRY_SHORTTOTAL=30s\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_KAFKA_VERBOSE=true\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_KAFKA_BROKERS="),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("192.168.24.204"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9092")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("192.168.24.205"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9092")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("192.168.24.206"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9092")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("192.168.24.207"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9092")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("working_dir")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /opt/gopath/src/github.com/hyperledger/fabric\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" orderer\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./channel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("artifacts/genesis.block"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/var/hyperledger/orderer/orderer.genesis.block\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./crypto"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("config/ordererOrganizations/example.com/orderers/orderer0.example.com/msp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/var/hyperledger/orderer/msp\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./crypto"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("config/ordererOrganizations/example.com/orderers/orderer0.example.com/tls/"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/var/hyperledger/orderer/tls\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("networks")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("default")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("aliases")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" aberic\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 7050"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7050")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("extra_hosts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.24.204\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.24.205\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.24.206\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.24.207\n")])])])]),t._v(" "),s("li",[s("p",[t._v("细节解释")]),t._v(" "),s("blockquote",[s("ol",[s("li",[t._v("环境变量\n"),s("ul",[s("li",[t._v("ORDERER_KAFKA_RETRY_LONGINTERVAL\n"),s("ul",[s("li",[t._v("每隔多长时间进行一次重试, 单位:秒")])])]),t._v(" "),s("li",[t._v("ORDERER_KAFKA_RETRY_LONGTOTAL\n"),s("ul",[s("li",[t._v("总共重试的时长, 单位: 秒")])])]),t._v(" "),s("li",[t._v("ORDERER_KAFKA_RETRY_SHORTINTERVAL\n"),s("ul",[s("li",[t._v("每隔多长时间进行一次重试, 单位:秒")])])]),t._v(" "),s("li",[t._v("ORDERER_KAFKA_RETRY_SHORTTOTAL\n"),s("ul",[s("li",[t._v("总共重试的时长, 单位: 秒")])])]),t._v(" "),s("li",[t._v("ORDERER_KAFKA_VERBOSE\n"),s("ul",[s("li",[t._v("启用日志与kafka进行交互, 启用: true, 不启用: false")])])]),t._v(" "),s("li",[t._v("ORDERER_KAFKA_BROKERS\n"),s("ul",[s("li",[t._v("指向kafka节点的集合")])])])])]),t._v(" "),s("li",[t._v("关于重试的时长\n"),s("ul",[s("li",[t._v("先使用"),s("code",[t._v("ORDERER_KAFKA_RETRY_SHORTINTERVAL")]),t._v("进行重连, 重连的总时长为"),s("code",[t._v("ORDERER_KAFKA_RETRY_SHORTTOTAL")])]),t._v(" "),s("li",[t._v("如果上述步骤没有重连成功, 使用"),s("code",[t._v("ORDERER_KAFKA_RETRY_LONGINTERVAL")]),t._v("进行重连, 重连的总时长为"),s("code",[t._v("ORDERER_KAFKA_RETRY_LONGTOTAL")])])])])])])])]),t._v(" "),s("h4",{attrs:{id:"_8-6-3-orderer各节点的配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-6-3-orderer各节点的配置"}},[t._v("#")]),t._v(" 8.6.3 orderer各节点的配置")]),t._v(" "),s("h5",{attrs:{id:"orderer0配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#orderer0配置"}},[t._v("#")]),t._v(" orderer0配置")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# orderer0.yaml")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("orderer0.test.com")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" orderer0.test.com\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" hyperledger/fabric"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("orderer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("latest\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=kafka_default\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_LOGLEVEL=debug\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_LISTENADDRESS=0.0.0.0\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_LISTENPORT=7050\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_GENESISMETHOD=file\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_GENESISFILE=/var/hyperledger/orderer/orderer.genesis.block\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_LOCALMSPID=OrdererMSP\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_LOCALMSPDIR=/var/hyperledger/orderer/msp\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# enabled TLS")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_TLS_ENABLED=false\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_TLS_PRIVATEKEY=/var/hyperledger/orderer/tls/server.key\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_TLS_CERTIFICATE=/var/hyperledger/orderer/tls/server.crt\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_TLS_ROOTCAS="),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("/var/hyperledger/orderer/tls/ca.crt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n      \n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_KAFKA_RETRY_LONGINTERVAL=10s\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_KAFKA_RETRY_LONGTOTAL=100s\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_KAFKA_RETRY_SHORTINTERVAL=1s\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_KAFKA_RETRY_SHORTTOTAL=30s\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_KAFKA_VERBOSE=true\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_KAFKA_BROKERS="),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("192.168.247.201"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9092")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("192.168.247.202"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9092")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("192.168.247.203"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9092")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("192.168.247.204"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9092")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("working_dir")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /opt/gopath/src/github.com/hyperledger/fabric\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" orderer\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./channel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("artifacts/genesis.block"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/var/hyperledger/orderer/orderer.genesis.block\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./crypto"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("config/ordererOrganizations/test.com/orderers/orderer0.test.com/msp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/var/hyperledger/orderer/msp\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./crypto"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("config/ordererOrganizations/test.com/orderers/orderer0.test.com/tls/"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/var/hyperledger/orderer/tls\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("networks")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("default")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("aliases")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 7050"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7050")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("extra_hosts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.201\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.202\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.203\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.204\n")])])]),s("h5",{attrs:{id:"orderer1配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#orderer1配置"}},[t._v("#")]),t._v(" orderer1配置")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# orderer1.yaml")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("orderer1.test.com")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" orderer1.test.com\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" hyperledger/fabric"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("orderer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("latest\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=kafka_default\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_LOGLEVEL=debug\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_LISTENADDRESS=0.0.0.0\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_LISTENPORT=7050\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_GENESISMETHOD=file\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_GENESISFILE=/var/hyperledger/orderer/orderer.genesis.block\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_LOCALMSPID=OrdererMSP\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_LOCALMSPDIR=/var/hyperledger/orderer/msp\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# enabled TLS")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_TLS_ENABLED=false\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_TLS_PRIVATEKEY=/var/hyperledger/orderer/tls/server.key\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_TLS_CERTIFICATE=/var/hyperledger/orderer/tls/server.crt\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_TLS_ROOTCAS="),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("/var/hyperledger/orderer/tls/ca.crt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n      \n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_KAFKA_RETRY_LONGINTERVAL=10s\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_KAFKA_RETRY_LONGTOTAL=100s\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_KAFKA_RETRY_SHORTINTERVAL=1s\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_KAFKA_RETRY_SHORTTOTAL=30s\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_KAFKA_VERBOSE=true\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_KAFKA_BROKERS="),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("192.168.247.201"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9092")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("192.168.247.202"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9092")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("192.168.247.203"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9092")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("192.168.247.204"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9092")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("working_dir")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /opt/gopath/src/github.com/hyperledger/fabric\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" orderer\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./channel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("artifacts/genesis.block"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/var/hyperledger/orderer/orderer.genesis.block\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./crypto"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("config/ordererOrganizations/test.com/orderers/orderer1.test.com/msp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/var/hyperledger/orderer/msp\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./crypto"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("config/ordererOrganizations/test.com/orderers/orderer1.test.com/tls/"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/var/hyperledger/orderer/tls\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("networks")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("default")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("aliases")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 7050"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7050")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("extra_hosts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.201\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.202\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.203\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.204\n")])])]),s("h5",{attrs:{id:"orderer2配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#orderer2配置"}},[t._v("#")]),t._v(" orderer2配置")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# orderer2.yaml")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("orderer2.test.com")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" orderer2.test.com\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" hyperledger/fabric"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("orderer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("latest\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=kafka_default\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_LOGLEVEL=debug\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_LISTENADDRESS=0.0.0.0\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_LISTENPORT=7050\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_GENESISMETHOD=file\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_GENESISFILE=/var/hyperledger/orderer/orderer.genesis.block\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_LOCALMSPID=OrdererMSP\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_LOCALMSPDIR=/var/hyperledger/orderer/msp\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# enabled TLS")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_TLS_ENABLED=false\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_TLS_PRIVATEKEY=/var/hyperledger/orderer/tls/server.key\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_TLS_CERTIFICATE=/var/hyperledger/orderer/tls/server.crt\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_GENERAL_TLS_ROOTCAS="),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("/var/hyperledger/orderer/tls/ca.crt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n      \n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_KAFKA_RETRY_LONGINTERVAL=10s\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_KAFKA_RETRY_LONGTOTAL=100s\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_KAFKA_RETRY_SHORTINTERVAL=1s\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_KAFKA_RETRY_SHORTTOTAL=30s\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_KAFKA_VERBOSE=true\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ORDERER_KAFKA_BROKERS="),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("192.168.247.201"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9092")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("192.168.247.202"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9092")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("192.168.247.203"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9092")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("192.168.247.204"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9092")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("working_dir")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /opt/gopath/src/github.com/hyperledger/fabric\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" orderer\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./channel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("artifacts/genesis.block"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/var/hyperledger/orderer/orderer.genesis.block\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./crypto"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("config/ordererOrganizations/test.com/orderers/orderer2.test.com/msp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/var/hyperledger/orderer/msp\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./crypto"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("config/ordererOrganizations/test.com/orderers/orderer2.test.com/tls/"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/var/hyperledger/orderer/tls\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("networks")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("default")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("aliases")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 7050"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7050")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("extra_hosts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.201\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.202\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.203\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" kafka4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("192.168.247.204\n")])])]),s("h3",{attrs:{id:"_8-7-启动集群"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-7-启动集群"}},[t._v("#")]),t._v(" 8.7. 启动集群")]),t._v(" "),s("blockquote",[s("p",[t._v("Kafka集群的启动顺序是这样的: 先启动"),s("code",[t._v("Zookeeper")]),t._v("集群, 随后启动"),s("code",[t._v("Kafka")]),t._v("集群, 最后启动"),s("code",[t._v("Orderer")]),t._v("排序服务器集群。由于peer节点只能和集群中"),s("code",[t._v("orderer")]),t._v("节点进行通信, 所以不管是使用solo集群还是kafka集群对peer都是没有影响的, 所以当我们的"),s("code",[t._v("kafka")]),t._v("集群顺利启动之后, 就可以启动对应的"),s("code",[t._v("Peer")]),t._v("节点了。")])]),t._v(" "),s("h4",{attrs:{id:"_8-7-1-启动zookeeper集群"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-7-1-启动zookeeper集群"}},[t._v("#")]),t._v(" 8.7.1 启动Zookeeper集群")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("zookeeper1:192.168.247.101")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~/kafka\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将写好的 zookeeper1.yaml 配置文件放到该目录下, 通过 docker-compose 启动容器")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 该命令可以不加 -d 参数, 这样就能看到当前 zookeeper 服务器启动的情况了")]),t._v("\n$ docker-compose -f zookeeper1.yaml up\n")])])])]),t._v(" "),s("li",[s("p",[t._v("zookeeper2:192.168.247.102")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~/kafka\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将写好的 zookeeper2.yaml 配置文件放到该目录下, 通过 docker-compose 启动容器")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 该命令可以不加 -d 参数, 这样就能看到当前 zookeeper 服务器启动的情况了")]),t._v("\n$ docker-compose -f zookeeper2.yaml up\n")])])])]),t._v(" "),s("li",[s("p",[t._v("zookeeper3:192.168.247.103")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~/kafka\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将写好的 zookeeper3.yaml 配置文件放到该目录下, 通过 docker-compose 启动容器")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 该命令可以不加 -d 参数, 这样就能看到当前 zookeeper 服务器启动的情况了")]),t._v("\n$ docker-compose -f zookeeper3.yaml up\n")])])])])]),t._v(" "),s("h4",{attrs:{id:"_8-7-2-启动kafka集群"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-7-2-启动kafka集群"}},[t._v("#")]),t._v(" 8.7.2 启动Kafka集群")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("kafka1:192.168.247.201")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~/kafka\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将写好的 kafka1.yaml 配置文件放到该目录下, 通过 docker-compose 启动容器")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 该命令可以不加 -d 参数, 这样就能看到当前 kafka 服务器启动的情况了")]),t._v("\n$ docker-compose -f kafka1.yaml up\n")])])])]),t._v(" "),s("li",[s("p",[t._v("kafka2:192.168.247.202")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~/kafka\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将写好的 kafka2.yaml 配置文件放到该目录下, 通过 docker-compose 启动容器")]),t._v("\n$ docker-compose -f kafka2.yaml up -d\n")])])])]),t._v(" "),s("li",[s("p",[t._v("kafka3:192.168.247.203")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~/kafka\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将写好的 kafka3.yaml 配置文件放到该目录下, 通过 docker-compose 启动容器")]),t._v("\n$ docker-compose -f kafka3.yaml up -d\n")])])])]),t._v(" "),s("li",[s("p",[t._v("kafka4:192.168.247.204")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~/kafka\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将写好的 kafka4.yaml 配置文件放到该目录下, 通过 docker-compose 启动容器")]),t._v("\n$ docker-compose -f kafka4.yaml up\n")])])])])]),t._v(" "),s("h4",{attrs:{id:"_8-7-3-启动orderer集群"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-7-3-启动orderer集群"}},[t._v("#")]),t._v(" 8.7.3 启动Orderer集群")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("orderer0:192.168.247.91")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~/kafka\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 假设生成证书和通道创始块文件操作是在当前 orderer0 上完成的, 那么应该在当前 kafka 工作目录下")]),t._v("\n$ tree ./ -L "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n./\n├── channel-artifacts\n├── configtx.yaml\n├── crypto-config\n└── crypto-config.yaml\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将写好的 orderer0.yaml 配置文件放到该目录下, 通过 docker-compose 启动容器")]),t._v("\n$ docker-compose -f orderer0.yaml up -d\n")])])])]),t._v(" "),s("li",[s("p",[t._v("orderer1:192.168.247.92")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将生成的 证书文件目录 和 通道创始块 文件目录拷贝到当前主机的 ~/kafka目录中")]),t._v("\n$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~/kafka\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 创建子目录 crypto-config")]),t._v("\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" crypto-config\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 远程拷贝")]),t._v("\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("scp")]),t._v(" -f itcast@192.168.247.91:/home/itcast/kafka/crypto-config/ordererOrganizations ./crypto-config\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# # 将写好的 orderer1.yaml 配置文件放到该目录下, 通过 docker-compose 启动容器")]),t._v("\n$ docker-compose -f orderer1.yaml up -d\n")])])])]),t._v(" "),s("li",[s("p",[t._v("orderer2:192.168.247.93")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将生成的 证书文件目录 和 通道创始块 文件目录拷贝到当前主机的 ~/kafka目录中")]),t._v("\n$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~/kafka\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 创建子目录 crypto-config")]),t._v("\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" crypto-config\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 远程拷贝")]),t._v("\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("scp")]),t._v(" -f itcast@192.168.247.91:/home/itcast/kafka/crypto-config/ordererOrganizations ./crypto-config\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# # 将写好的 orderer3.yaml 配置文件放到该目录下, 通过 docker-compose 启动容器")]),t._v("\n$ docker-compose -f orderer3.yaml up -d\n")])])])])]),t._v(" "),s("h4",{attrs:{id:"_8-7-4-启动peer集群"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-7-4-启动peer集群"}},[t._v("#")]),t._v(" 8.7.4 启动Peer集群")]),t._v(" "),s("blockquote",[s("p",[t._v("关于 Peer 节点的部署和操作和 Solo 多机多节点部署的方式是完全一样的, 在此不再阐述, 请查阅第七章。")])])])}),[],!1,null,null,null);a.default=e.exports}}]);