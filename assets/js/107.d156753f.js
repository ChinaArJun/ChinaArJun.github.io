(window.webpackJsonp=window.webpackJsonp||[]).push([[107],{656:function(s,t,e){"use strict";e.r(t);var a=e(44),r=Object(a.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"使用-helm-部署-postgres"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用-helm-部署-postgres"}},[s._v("#")]),s._v(" 使用 helm 部署 postgres")]),s._v(" "),e("h2",{attrs:{id:"前置知识"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#前置知识"}},[s._v("#")]),s._v(" 前置知识")]),s._v(" "),e("ul",[e("li")]),s._v(" "),e("h2",{attrs:{id:"部署"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#部署"}},[s._v("#")]),s._v(" 部署")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用 helm v2 部署")]),s._v("\n$ helm "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" stable/postgresql\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用 helm v3 部署")]),s._v("\n$ helm "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" postgres stable/postgresql\nNAME: postgres\nLAST DEPLOYED: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),s._v("-10-21 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":33:59.742081417 +0800 CST "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("m")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("+2.283315306\nNAMESPACE: default\nSTATUS: deployed\nNOTES:\n** Please be patient "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" the chart is being deployed **\n\nPostgreSQL can be accessed via port "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5432")]),s._v(" on the following DNS name from within your cluster:\n\n    postgres-postgresql.default.svc.cluster.local - Read/Write connection\nTo get the password "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"postgres"')]),s._v(" run:\n\n    "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("POSTGRES_PASSWORD")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("kubectl get secret --namespace default postgres-postgresql -o "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("jsonpath")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{.data.postgresql-password}"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" base64 --decode"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n\nTo connect to your database run the following command:\n\n    kubectl run postgres-postgresql-client --rm --tty -i --restart"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Never'")]),s._v(" --namespace default --image docker.io/bitnami/postgresql:11.5.0-debian-9-r60 --env"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"PGPASSWORD='),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$POSTGRES_PASSWORD")]),s._v('"')]),s._v(" --command -- psql --host postgres-postgresql -U postgres -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5432")]),s._v("\n\n\n\nTo connect to your database from outside the cluster execute the following commands:\n\n    kubectl port-forward --namespace default svc/postgres-postgresql "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5432")]),s._v(":5432 "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PGPASSWORD")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$POSTGRES_PASSWORD")]),s._v('"')]),s._v(" psql --host "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 -U postgres -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5432")]),s._v("\n")])])])])}),[],!1,null,null,null);t.default=r.exports}}]);